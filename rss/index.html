<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[iyWare]]></title><description><![CDATA[Things I Break]]></description><link>https://iyware.com/</link><generator>Ghost 0.5</generator><lastBuildDate>Wed, 04 Mar 2015 02:37:47 GMT</lastBuildDate><atom:link href="https://iyware.com/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Proxy Ghost with Homebrew Apache]]></title><description><![CDATA[<p>I don't know if you're like me, but I'm lazy.  As such I find adding ports to URLs to be quite tedius, so the fact that <a href="https://ghost.org/">Ghost</a> runs on a non-standard web port (<code>:2368</code> as opposed to <code>:80</code>) bugs me.  I know it's so that it can run in userspace and not colide with any other services, but still.  So in this post we'll outline how to fix that.</p>

<p>This outline should work for any version of <a href="http://httpd.apache.org/">Apache</a> but I'm using <a href="http://brew.sh/">homebrew</a> <a href="https://github.com/Homebrew/homebrew-apache/blob/master/httpd24.rb">Apache 2.4</a> using the <code>--with-privileged-ports</code> switch to run on port 80 but Apache can be running on any port.  If you're looking for how to install Apache I've written about it before <a href="https://iyware.com/osx-yosemite-mamp-homebrew-development-setup/">here</a>.</p>

<h2 id="enableapachemods">Enable Apache Mods</h2>

<p>We need to enable 2 modules to allow Ghost to be proxied by Apache, <a href="http://httpd.apache.org/docs/current/mod/mod_proxy.html"><code>mod_proxy</code></a> (which enables proxy in general) and <a href="http://httpd.apache.org/docs/current/mod/mod_proxy_http.html"><code>mod_proxy_http</code></a> (which enables HTTP proxy specifically).</p>

<p>Navigate to your <code>httpd.conf</code> file located at <code>/usr/local/etc/apache2/2.4/</code> and open it with your favorite editor.</p>

<p><img src="https://iyware.com/content/images/2015/02/folder-containing-homebrew-apache-config.png" alt=""></p>

<p>Locate the lines for <code>proxy_module</code> and <code>proxy_http_module</code> and uncomment them by removing the <code>#</code> at the beginning of the line so that:</p>

<pre><code class="language-apacheconf">#LoadModule proxy_module libexec/mod_proxy.so
</code></pre>

<p>becomes:</p>

<pre><code class="language-apacheconf">LoadModule proxy_module libexec/mod_proxy.so  
</code></pre>

<p>The snippet of that whole section should look something like this:</p>

<pre><code class="language-apacheconf">#LoadModule remoteip_module libexec/mod_remoteip.so
LoadModule proxy_module libexec/mod_proxy.so  
#LoadModule proxy_connect_module libexec/mod_proxy_connect.so
#LoadModule proxy_ftp_module libexec/mod_proxy_ftp.so
LoadModule proxy_http_module libexec/mod_proxy_http.so  
#LoadModule proxy_fcgi_module libexec/mod_proxy_fcgi.so
#LoadModule proxy_scgi_module libexec/mod_proxy_scgi.so
</code></pre>

<p>Your settings may vary depending on other modules that you have previously enabled, the important thing is that both modules are uncommented.</p>

<h2 id="addanapachevhost">Add an Apache VHost</h2>

<p>The next step is to define an Apache VirtualHost declaration essentially stating how the proxy should work.  In the same <code>httpd.conf</code> document scroll all the way to the bottom and add the following snippet:</p>

<pre><code class="language-apacheconf">&lt;VirtualHost example.com:80&gt;  
     ServerName example.com
     ProxyRequests off
     ProxyPass / http://127.0.0.1:2368/
     ProxyPassReverse / http:/127.0.0.1:2368/
&lt;/VirtualHost&gt;  
</code></pre>

<p>You'll need to replace <code>example.com</code> with the domain that you'd like to access Ghost from.  If it's a localhost installation I highly suggest that you consider leveraging DNSmasq and mod_vhost_alias as well as this works well with that solution as well.  If you want more information about localhost development I've written previously about it <a href="https://iyware.com/yosemite-mamp-homebrew-dev-setup-part-2/#dnsmasq">here</a>.</p>

<p>My VHost looks like this:</p>

<pre><code class="language-apacheconf">&lt;VirtualHost ghost.localhost:80&gt;  
     ServerName ghost.localhost
     ProxyRequests off
     ProxyPass / http://127.0.0.1:2368/
     ProxyPassReverse / http:/127.0.0.1:2368/
&lt;/VirtualHost&gt;  
</code></pre>

<h2 id="restartapache">Restart Apache</h2>

<p>After you've finished editing your config file save it and then restart Apache with this command:</p>

<pre><code class="language-bash">sudo httpd -k restart  
</code></pre>

<p>This will immediately restart your Apache server, even if you're using a LaunchAgent to start it on load or log in.</p>

<p>Now you can visit the URL you declared in your Apache configuration and access your Ghost instance.  Please note that you can still visit it from the old URL as well, this doesn't block access, so if Apache ever breaks you can still get to Ghost.</p>]]></description><link>https://iyware.com/proxy-ghost-with-homebrew-apache/</link><guid isPermaLink="false">a45f48e9-c05f-418e-8d1f-b2aa4d59988f</guid><category><![CDATA[DevOps]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Fri, 13 Feb 2015 04:55:19 GMT</pubDate></item><item><title><![CDATA[Secure Ghost With Cloudflare SSE]]></title><description><![CDATA[<p><a href="https://www.cloudflare.com/">Cloudflare</a> is a great company for so many reasons.  They provide DNS, CDN, and security all in one &dash; even on their free tier.  If you're not using Cloudflare yet, you should consider it.  In this post we'll look at integrating <a href="https://support.cloudflare.com/hc/en-us/articles/200170036">Cloudflare SSE</a> (Server Side Exclusion) to your Ghost theme.</p>

<p>Cloudflare SSE is a cool feature that will simply strip out any content that you want at the time it's being served to the user, but only for users (IP addresses/ranges) that Cloudflare knows to be a threat.  So instead of completely blocking a user from your site in the event of a false-positive, which happens, you can prevent them from seeing only certain info like contact info, or comments.</p>

<h2 id="enablesse">Enable SSE</h2>

<p>If you don't have your domain set up with Cloudflare yet you'll need to that, which is beyond the scope of this article, but fairly straight forward.  After you've added your domain to Cloudflare click the 'settings' wheel and select "CloudFlare Settings" from the drop-down menu.</p>

<p><img src="https://iyware.com/content/images/2015/02/cloudflare-settings-for-a-domain.png" alt=""></p>

<p>Depending on the security profile that you selected when configuring your domain you may or may not have different options enabled, but you'll need to check that SSE is enabled anyways.  On the CloudFlare Settings page click the "Security Settings" tab.</p>

<p><img src="https://iyware.com/content/images/2015/02/cloudflare-security-settings-tab.png" alt=""></p>

<p>Scroll down the settings page until until you see the "Server side exclude (SSE)" option and enable it.</p>

<p><img src="https://iyware.com/content/images/2015/02/cloudflare-SEE-enabled.png" alt=""></p>

<p>That's it to enable you SSE on your site, but it won't do anything until you add the SSE tags to your blog template.</p>

<h2 id="modifyyourghosttheme">Modify Your Ghost Theme</h2>

<p>Now that SSE is enabled you need to decide what exactly you want to exclude.  Generally I exclude any calls to the <a href="http://themes.ghost.org/v0.5.8/docs/author">author theme API</a> with either <code>{{author}}</code> or <code>{{#author}}{{/author}}</code> as well as components of the <a href="http://themes.ghost.org/v0.5.8/docs/blog">@blog</a> API.  Again this is up to you.</p>

<h3 id="excludeyourpersonalinfo">Exclude Your Personal Info</h3>

<p>In your theme find the <code>post.hbs</code> file and find the <code>{{#author}}{{/author}}</code> section.  In order to exclude it you're simply going to wrap it in HTML comments <code>&lt;!--sse--&gt;&lt;!--/sse--&gt;</code> like this:</p>

<pre><code class="language-handlebars">    &lt;!--sse--&gt;
        {{#author}}
            ...
        {{/author}}
    &lt;!--/sse--&gt;
</code></pre>

<p>The default Ghost theme "Casper" should look like this:</p>

<pre><code class="language-handlebars">        &lt;!--sse--&gt;
        {{! Everything inside the #author tags pulls data from the author }}
        {{#author}}

            {{#if image}}
            &lt;figure class="author-image"&gt;
                &lt;a class="img" href="{{url}}" style="background-image: url({{image}})"&gt;&lt;span class="hidden"&gt;{{name}}'s Picture&lt;/span&gt;&lt;/a&gt;
            &lt;/figure&gt;
            {{/if}}

            &lt;section class="author"&gt;
                &lt;h4&gt;&lt;a href="{{url}}"&gt;{{name}}&lt;/a&gt;&lt;/h4&gt;

                {{#if bio}}
                    &lt;p&gt;{{bio}}&lt;/p&gt;
                {{else}}
                    &lt;p&gt;Read &lt;a href="{{url}}"&gt;more posts&lt;/a&gt; by this author.&lt;/p&gt;
                {{/if}}
                &lt;div class="author-meta"&gt;
                    {{#if location}}&lt;span class="author-location icon-location"&gt;{{location}}&lt;/span&gt;{{/if}}
                    {{#if website}}&lt;span class="author-link icon-link"&gt;&lt;a href="{{website}}"&gt;{{website}}&lt;/a&gt;&lt;/span&gt;{{/if}}
                &lt;/div&gt;
            &lt;/section&gt;

        {{/author}}
        &lt;!--/sse--&gt;
</code></pre>

<p>Now whenever a visitor that CloudFlare deems a "threat" accesses a post that whole section will be excluded.</p>

<h3 id="excludesharelinks">Exclude Share Links</h3>

<p>In <code>post.hbs</code> right below the <code>{{author}}</code> section you can remove the "share" links:</p>

<pre><code class="language-handlebars">            &lt;!--sse--&gt;
            &lt;section class="share"&gt;
                &lt;h4&gt;Share this post&lt;/h4&gt;
                &lt;a class="icon-twitter" href="https://twitter.com/share?text={{encode title}}&amp;amp;url={{url absolute="true"}}"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"&gt;
                    &lt;span class="hidden"&gt;Twitter&lt;/span&gt;
                &lt;/a&gt;
                &lt;a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u={{url absolute="true"}}"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"&gt;
                    &lt;span class="hidden"&gt;Facebook&lt;/span&gt;
                &lt;/a&gt;
                &lt;a class="icon-google-plus" href="https://plus.google.com/share?url={{url absolute="true"}}"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;"&gt;
                    &lt;span class="hidden"&gt;Google+&lt;/span&gt;
                &lt;/a&gt;
            &lt;/section&gt;
            &lt;!--/sse--&gt;
</code></pre>

<h3 id="exludecomments">Exlude Comments</h3>

<p>If you've integrated comments into your site, you're likely doing so via JavaScript loading as Ghost (as of this writing) doesn't support native comments.  So you can simply exclude those too (in <code>post.hbs</code>):</p>

<pre><code class="language-handlebars">                &lt;!--sse--&gt;
            &lt;div id="disqus_thread"&gt;&lt;/div&gt;
            &lt;script type="text/javascript"&gt;
                var disqus_shortname = 'yoursite';
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            &lt;/script&gt;
            &lt;noscript&gt;&lt;p style="text-align:center;"&gt;&lt;small&gt;Please enable JavaScript to view the &lt;a href="https://disqus.com/home/forums/yoursite/"&gt;comments powered by Disqus.&lt;/a&gt;&lt;/small&gt;&lt;/p&gt;&lt;/noscript&gt;
            &lt;!--/sse--&gt;
</code></pre>

<p>And now a "threat" won't be able to access your comments via your site, of course I can't comment on the security of Disqus itself.</p>

<h3 id="excludeanything">Exclude Anything</h3>

<p>You can exclude anything you want from your theme templates, if you've added say a phone number or an email address that can be excluded too.</p>

<pre><code class="language-handlebars">&lt;!--sse--&gt;danny &amp;#64; iyware.com&lt;!--/sse--&gt;  
</code></pre>

<h3 id="excludepostcontent">Exclude Post Content</h3>

<p>Due to the ethos behind <a href="http://daringfireball.net/projects/markdown/">Markdown</a> HTML comments are not supported within the Ghost editor so you won't be able to add SSE to the content of a post.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Using CloudFlare SSE is just one small step toward securing your Ghost blog but it should be an effective step.  If you trust CloudFlare's analytics there's quite a bit of malicious activity out there (8% on my site).</p>

<p><img src="https://iyware.com/content/images/2015/02/cloudflare-threat-analytics.png" alt=""></p>

<p>My guess would be that this is mostly bots looking for vulnerabilities, but still they're out there trying to crawl your personal info, spam your comments, and generally ruin your day.  So take a few minutes and add another layer of security to your blog.</p>]]></description><link>https://iyware.com/secure-ghost-with-cloudflare-sse/</link><guid isPermaLink="false">34dfcafe-bca4-4c0b-b662-9dc65eb110ec</guid><category><![CDATA[Ghost]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Thu, 12 Feb 2015 11:55:47 GMT</pubDate></item><item><title><![CDATA[Enable Accessibility Zoom on iOS 8]]></title><description><![CDATA[<p>When <a href="https://www.apple.com/osx/all-features/">OS X 10.10 was released</a> one of the coolest new features was the ability to use your iOS device as an input 'camera' in QuickTime capture.  This feature was a great addition for teachers at <a href="https://tiseagles.com/">Tianjin International School</a> - which had just rolled out its 1:1 iPad program in grades 3-6.  Recording the screen of the iPad allowed the teacher to make demonstrative tutorials for their students.</p>

<p>I was asked to create an example of a screen-captured video, so I figured that I would kill two birds with one stone as another teacher had asked about how to record only a certain part of a screen or to show only a part of a screen.  Instead of telling him how, I decided to create a video demonstrating how to enable, and use Zoom under iOS Accessibility settings.</p>

<iframe width="640" height="480" src="https://www.youtube-nocookie.com/embed/ymQWahmrvLU?rel=0" frameborder="0" allowfullscreen></iframe>

<p>This video was completely unscripted, and actually what you just saw was the 4th or 5th take as I did things like accidentally show my lastpass password or already have zoom enabled in the other takes.</p>]]></description><link>https://iyware.com/enable-accessibility-zoom-on-ios-8/</link><guid isPermaLink="false">41a8e1e6-4c9f-415a-95b5-80839313244c</guid><category><![CDATA[Education]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Fri, 06 Feb 2015 01:53:36 GMT</pubDate></item><item><title><![CDATA[Ghost on GitHub Pages With HTTrack]]></title><description><![CDATA[<p>I've written a little bit about this before but this site is currently created using a local copy of <a href="https://tryghost.org/">Ghost</a> and then converted to a static HTML site and deployed to GitHub pages.  This post will overview how I do that.</p>

<p>First I'd like to say that I am aware of, and initially used, the tool <a href="https://github.com/axitkhurana/buster">Buster</a> (get it, Ghost Buster), it's a fine little utility that basically functions as a fancy <code>wget</code> wrapper, but it has some <a href="https://github.com/axitkhurana/buster/issues/">issues</a>.  Issues that were preventing this site from being fully functional.  In the author's defense- some of it may have actually been caused by <a href="http://brew.sh/">homebrew</a>'s wget.  So I decided to investigate an alternative toolset.</p>

<p>This bring us to <a href="http://www.httrack.com/">HTTrack</a>.  <code>httrack</code> is an alternative website downloader (like <code>wget</code>) and is available for just about <a href="http://www.httrack.com/page/2/en/">every platform</a>.  HTTrack has a lot of options, and if you need something fancy I recommend that you <a href="http://www.httrack.com/html/fcguide.html">read the guide</a>.  That said, here's a step-by-step to deploy your Ghost blog to GitHub Pages.</p>

<h2 id="initializeyourgitrepository">Initialize Your Git Repository</h2>

<p>I'll go over how to deploy to a user (or organization) page on <a href="https://help.github.com/articles/user-organization-and-project-pages/">Github Pages</a>.  If you need to do it for a project, just replace the user steps with the steps necessary for your repo, but generally it's just using the <code>gh-pages</code> branch instead of <code>master</code>.</p>

<p>Create the directory that you want to init as a git repository and open a terminal prompt in that directory.  HTTrack will create some meta files (a cache and a log) and clone your site to something that is ASCII safe.  So for example if your Ghost blog is running on <code>http://localhost:2368</code> which is the default, from your output directory HTTrack will create:</p>

<ul>
<li><code>./hts-cache/</code></li>
<li><code>./hts-log.txt</code></li>
<li><code>./localhost_2368/</code></li>
</ul>

<p>with <code>./localhost_2368/</code> containing your static site.  So you'll need to initialize your git repository there.  I have mine in <code>~/Sites/htdocs/iyware.com/localhost_2368/</code></p>

<pre><code class="language-bash">mkdir ~/Sites/htdocs/iyware.com/localhost_2368/  
cd ~/Sites/htdocs/iyware.com/localhost_2368/  
git init  
git checkout -b master  
git remote add origin git@github.com:[USER NAME]/[USER NAME].github.io.git  
</code></pre>

<p>A few notes here:</p>

<ol>
<li>Replace <code>[USER NAME]</code> with your user name, or organization name.  </li>
<li>Replace <code>-b master</code> with <code>-b gh-pages</code> if this is a project page.  </li>
<li>You don't have to use the SSH repository path, you can use HTTPS but you'll be prompted to authenticate every time you update your site. If you don't have <a href="https://help.github.com/articles/generating-ssh-keys/">SSH configured</a>, I strongly suggest you do it.</li>
<li>If you have things in your repository you might want to <code>git fetch</code> and <code>git merge</code> them- but you probably don't.  Even if you blow them away locally, they'll still be in your commit history.</li>
</ol>

<p>Initializing your Git repository is obviously a one time task.</p>

<h2 id="generateyourinitialstaticsite">Generate Your Initial Static Site</h2>

<p>One of the dowsides of HTTrack to wget is that it seems to be a bit slower.  One of the benefits that HTTrack has over wget is its cache.  That means that the first crawl of your site is going to be considerably slower than using wget (or buster) but updates to your site should be relatively quick.  Luckily we can begin the process with a single command.  The directory from where you run this command doesn't matter:</p>

<pre><code class="language-bash">httrack http://localhost:2368/ -O /PATH/TO/OUTPUT/FOLDER/ -c128 -I0 -#p "+sitemap*"  
</code></pre>

<p>Let's break this command down a little bit.  The first parameter is the path to the site you want to crawl, e.g. your ghost blog.  The second parameter <code>-O</code> is the path to the output folder.  You'll obviously need to replace <code>/PATH/TO/OUTPUT/FOLDER/</code> with your actual path (NOT the <code>localhost_2368</code> folder but it's parent.  Mine is <code>/Users/dannywahl/Sites/htdocs/iyware.com/</code>.  <code>-c128</code> means that we scrape with a rate of 128 simulatneous connections.  <code>-I0</code> tells httrack not to make a custom / file for the output and <code>-#p</code> is detailed output (verbose).</p>

<p>The <code>"+sitemap*"</code> tells httrack to explicitly to grab any links to a sitemap.  Ghost automatically generates a sitemap, but it uses <code>@blog.url</code> to populate them so httrack will not scrape them by default- so we need add this command.  This might be dangerous if you blog content contains a lot of links to other sites' sitemaps.  You might consider changing it to your Ghost blog url, e.g. <code>"+https://iyware.com/sitemap*"</code> to only grab your site's sitemap.</p>

<p>If it all goes right you'll see the progress of your site scrape in the terminal output like this:</p>

<pre><code class="language-bash">Mirror launched on Wed, 04 Feb 2015 12:06:11 by HTTrack Website Copier/3.48-19 [XR&amp;CO'2014]  
mirroring http://localhost:2368/ +/sitemap* with the wizard help..  
...
Thanks for using HTTrack!  
</code></pre>

<p>Now you should have a fully viewable static site in <code>/localhost_2368/</code> that is ready to deploy to GitHub Pages.</p>

<h2 id="deploytogithubpages">Deploy to GitHub Pages</h2>

<p>In terminal navigate back to the <code>/localhost_2368/</code> directory and commit at push your changes to GitHub:</p>

<pre><code class="language-bash">git add .  
git commit -m "Blog updated"  
git push -u origin master  
</code></pre>

<p>Now you should be able to visit your GitHub page and see the static version of your site.</p>

<h3 id="updateyourstaticsite">Update Your Static Site</h3>

<p>The next time you update your Ghost blog and you need to update your static site navigate to the folder containing <code>/localhost_2368/</code> and run this command:</p>

<pre><code class="language-bash">httrack -iC2  
</code></pre>

<p>This command updates your site and reuses your cache, you don't need to do a full re-scrape.  It will delete items that are remotely deleted, update changed assets, and it will add new files.  Then push to GitHub again.</p>

<h3 id="wrapitinashellscript">Wrap it in a Shell Script</h3>

<p>After the initial static site is created and the git repository is created it's quite a simple and repetitive task to update and deploy, so you can stick it all in a simple shell script like this:</p>

<pre><code class="language-bash"># working path
cd /Users/dannywahl/Sites/htdocs/iyware.com/

# update
httrack -iC2

# replace favicon
mv favicon.ico localhost_2368/favicon.ico

# deploy
cd /Users/dannywahl/Sites/htdocs/iyware.com/localhost_2368/

current_time=$(date -u +"%Y-%m-%d %T")  
git add .  
git commit -m "Blog update at $current_time"  
git push -u origin master  
echo "Deployed to github"  
</code></pre>

<p>I have that saved as a utility called <code>bustit</code> so now I can simply type <code>bustit</code> in terminal to deploy my updated blog.</p>

<p>It's not nearly as robust as <code>buster</code> but it very easily could be- it's the same wrapper for a site downloader and a git interface, I just didn't make it modular or extensible, maybe I will in the future.</p>

<h2 id="extras">Extras</h2>

<p>If you're not happy with the look of your sitemaps it's because <code>sitemap.xsl</code> is missing- you'll need to visit <code>http://localhost:2368/sitemap.xsl</code> and save that to the static site root (next to <code>sitemap.xml</code>).  I can't figure out how to get httrack (or buster) to download this- but you only need to do that the first time.  This file is not necessary.</p>

<p>If you're used to using <code>buster</code> it automatically adds a <code>README</code> file to your site.  You'll need to create that manually if you want it.  Same for <code>CNAME</code> and <code>robots.txt</code>.</p>

<p>Well that's all there is to it.  Create an initial static copy, update that copy when you update Ghost, and push to github.  Maybe in the future I'll rewrite this as a robust application because I think it would be cool to integrate it with AppleScript Folder Actions so that whenever the Ghost sqlite database is updated this triggers, but for now this works just fine.</p>]]></description><link>https://iyware.com/host-your-ghost-blog-on-github-pages/</link><guid isPermaLink="false">593db4b6-71ff-4e7b-8324-b7bc45332744</guid><category><![CDATA[Ghost]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Wed, 04 Feb 2015 05:41:23 GMT</pubDate></item><item><title><![CDATA[Start Your Ghost NPM Server on Mac Log In]]></title><description><![CDATA[<p>If you follow the <a href="http://support.ghost.org/installing-ghost-mac/">Ghost documentation</a> to install and start Ghost then you probably just open terminal, <code>cd</code> to your install directory and type <code>npm start</code>, this leaves you with a terminal window always opened.  There's a few simple steps you can take to get node, and therefore Ghost, running on log in on OS X.</p>

<p>The first is to install the NPM package <a href="https://www.npmjs.com/package/forever-mac">forever</a>:</p>

<pre><code class="language-bash">npm install forever -g  
</code></pre>

<p>Next you should copy this <code>.plist</code> and save it to <code>~/Library/LaunchAgents/node.forever.ghost.plist</code>.</p>

<pre><code class="language-markup">&lt;?xml version="1.0" encoding="UTF-8"?&gt;  
&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;  
&lt;plist version="1.0"&gt;  
&lt;dict&gt;  
    &lt;key&gt;KeepAlive&lt;/key&gt;
    &lt;dict&gt;
        &lt;key&gt;SuccessfulExit&lt;/key&gt;
        &lt;false/&gt;
    &lt;/dict&gt;
    &lt;key&gt;Label&lt;/key&gt;
    &lt;string&gt;node.forever.ghost&lt;/string&gt;
    &lt;key&gt;ProgramArguments&lt;/key&gt;
    &lt;array&gt;
        &lt;string&gt;/usr/local/bin/node&lt;/string&gt;
        &lt;string&gt;/usr/local/bin/forever&lt;/string&gt;
        &lt;string&gt;start&lt;/string&gt;
        &lt;string&gt;[PATH TO GHOST]/ghost/index.js&lt;/string&gt;
    &lt;/array&gt;
    &lt;key&gt;RunAtLoad&lt;/key&gt;
    &lt;true/&gt;
&lt;/dict&gt;  
&lt;/plist&gt;  
</code></pre>

<p>replacing <code>[PATH TO GHOST]</code> with the path to your Ghost installation.  Finally load the launchAgent:</p>

<pre><code class="language-bash">launchctl load ~/Library/LaunchAgents/node.forever.ghost.plist  
</code></pre>

<p>Now you can head to your ghost URL (default <a href="http://localhost:2368/">http://localhost:2368</a>) and start blogging- node forever will start ghost every time you log in to your Mac.</p>]]></description><link>https://iyware.com/start-your-ghost-npm-server-on-mac-log-in/</link><guid isPermaLink="false">f79a2079-9d27-47ea-aaca-33a653703298</guid><category><![CDATA[Ghost]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Tue, 03 Feb 2015 00:39:00 GMT</pubDate></item><item><title><![CDATA[Add Search to Your Ghost Blog with Swiftype]]></title><description><![CDATA[<p>If you're moving from WordPress to Ghost (or really any other blog platform) one of the things you've probably noticed is sorely missing is search.  The Ghost devs know it too.  Adding search is on the roadmap, unfortunately it's <a href="https://trello.com/c/tNNWYXzf/51-search">backlogged</a> and they're currently looking for a <a href="https://ghost.org/contribute/search-lead/">Search Lead</a> developer.  So I wouldn't count on native search coming for a while- like maybe 0.7.</p>

<p>In the meantime, it's not that hard to integrate a third-party service into your Ghost site, and in this post I'll show you how to do it using <a href="https://swiftype.com/">Swiftype</a>.  What is Swiftype?</p>

<blockquote>
  <p>Swiftype is a hosted software service that eliminates the need to create your own search software from scratch, making it possible for any website owner or mobile app developer to add great search to their product.</p>
</blockquote>

<p>Sounds exactly like what we need!</p>

<h2 id="signupforswiftype">Sign up for Swiftype</h2>

<p>Head on over to the <a href="https://swiftype.com/pricing">Swiftype pricing page</a> page and scout out the plan that you want.  Personally I'm just using the free plan.</p>

<p><img src="https://iyware.com/content/images/2015/01/swiftype-pricing-overview.png" alt=""></p>

<p>Another option available is to activate Smart Errors as an app in your<a href="https://www.cloudflare.com/zone-picker?from=/cloudflare-apps"> Cloudflare dashboard</a> if you're using Cloudflare.  This will also give you the added benefit of having a better 404 page than this: <code>;&gt; &lt;</code></p>

<p><img src="https://iyware.com/content/images/2015/01/smart-errors-cloudflare-app.png" alt=""></p>

<p>After you've enabled smart errors head to your <a href="https://swiftype.com/home">swiftype dashboard</a> and create what they call a "<a href="https://swiftype.com/engines/new">Search Engine</a>" which is actually a search context (generally a domain- but you can have it search multiple domains).</p>

<p><img src="https://iyware.com/content/images/2015/02/swiftype-search-engine-overview.png" alt=""></p>

<h2 id="option1addswiftypesearchwithcloudflare">Option 1: Add Swiftype Search with Cloudflare</h2>

<p>After you've created your account you can very simply integrate Swiftype search into your site by heading back to Cloudflare and enabling the <a href="https://www.cloudflare.com/apps/swiftype_search">Swiftype Search</a> app.  This will provide the most basic integration- a simple 'search' button gets injected into your pages.  It's crude, but it works.</p>

<h2 id="option2addswiftypetoyourghosttheme">Option 2: Add Swiftype to Your Ghost Theme</h2>

<p>If you're looking for a richer integration then you will need to install the Swiftype code to your Ghost theme template.  There are a variety of ways to do this- you could add a search icon to your footer, or to your <code>default.hbs</code> template file if you want every page to be searchable.  However, I'll be showing you how to make a static search page with an embedded search form.</p>

<p>Go back to the Swiftype page and inside your search engine choose "Install" from the toolbar.</p>

<p><img src="https://iyware.com/content/images/2015/02/swiftype-searchengine-toolbar.png" alt=""></p>

<h3 id="downloadswiftypeautocompletesearch">Download Swiftype Autocomplete &amp; Search</h3>

<p>Before you install the integration code you'll need to download the packages.  You could do it with git so you can upgrade in the future (make sure you initialize as a submodule if ghost is a git module too!).  Or you can simply download them:</p>

<ul>
<li><a href="https://github.com/swiftype/swiftype-autocomplete-jquery">Swiftype autocomplete</a></li>
<li><a href="https://github.com/swiftype/swiftype-search-jquery">Swiftype search</a></li>
</ul>

<p>Notice that these are jQuery plugins.  It shouldn't be an issue as <code>{{ghost_foot}}</code> will insert jQuery into your theme- and that should be a part of your theme!</p>

<h3 id="addautocompletesearchtoyourthemefolder">Add Autocomplete &amp; Search to your Theme Folder</h3>

<p>Navigate to <code>/ghost/content/themes/[your theme]/assets/js/</code> where <code>/ghost/</code> is your ghost installation directory and <code>[your theme]</code> is your theme name (default is casper).  If your theme doesn't have a <code>js</code> folder you can create one.  Move the JavaScript files from the Swiftype downloads into this folder.  Note that you don't need all the files, only the <code>.js</code> files:</p>

<ul>
<li>jquery.swiftype.autocomplete.js</li>
<li>jquery.ba-hashchange.min.js</li>
<li>jquery.swiftype.search.js</li>
</ul>

<p><img src="https://iyware.com/content/images/2015/02/swiftype-js-files-added-to-ghost.png" alt=""></p>

<p>Now do the same thing for the CSS files but in the <code>/assets/css/</code> folder:</p>

<ul>
<li>autocomplete.css</li>
<li>search.css</li>
</ul>

<p><img src="https://iyware.com/content/images/2015/02/swiftype-css-files-added-to-ghost.png" alt=""></p>

<p>Optionally you can concatenate the CSS to the end of the Ghost CSS file <code>screen.css</code>, which is probably a better idea because it will save you 2 HTTP requests and a little bit of bandwidth.</p>

<h3 id="addautocompletesearchtoyourthemetemplate">Add Autocomplete &amp; Search to your Theme Template</h3>

<p>Now that you have added the files to your Ghost <code>/assets/</code> folder you can insert them into your theme template files.  Navigate to <code>/Ghost/content/themes/[your theme]/</code> and open up <code>default.hbs</code>.  The reason that we need to edit the default template is because the function <code>{{ghost_foot}}</code> outputs the jQuery call.  If you call Swiftype before jQuery is loaded (e.g. in <code>page.hbs</code>) you'll get an error.</p>

<p>In <code>default.hbs</code> find the line with <code>{{ghost-foot}}</code> and add the following:</p>

<pre><code class="language-handlebars">        &lt;script src="{{asset "js/jquery.swiftype.autocomplete.js"}}"&gt;&lt;/script&gt;
        &lt;script src="{{asset "js/jquery.ba-hashchange.min.js"}}"&gt;&lt;/script&gt;
        &lt;script src="{{asset "js/jquery.swiftype.search.js"}}"&gt;&lt;/script&gt;

        &lt;script type="text/javascript"&gt;
            $("#st-search-input").swiftype({
                engineKey: "XXXXXXXXXX"
            });
            $("#st-search-input").swiftypeSearch({
                engineKey: "XXXXXXXXXX",
                resultContainingElement: "#st-results-container"
            });
        &lt;/script&gt;
</code></pre>

<p>Notice that we're using the <a href="http://themes.ghost.org/v0.5.8/docs/asset"><code>{{asset }}</code></a> API so you don't have to worry about the full path, Ghost will build it for you.  You'll need to replace <code>engineKey: "XXX"</code> with your engine key, found on your Swiftkey dashboard.</p>

<p>If you want search to be available on every page (you'll still have to add a search form to <code>default.hbs</code> then leave the code as is.  If you intend to only have search available on a specific search page then you can wrap the above code in <a href="http://themes.ghost.org/v0.5.8/docs/is"><code>{{is}}</code></a> brackets:</p>

<pre><code class="language-handlebars">    {{#is 'page'}}
        &lt;script src="{{asset "js/jquery.swiftype.autocomplete.js"}}"&gt;&lt;/script&gt;
        &lt;script src="{{asset "js/jquery.ba-hashchange.min.js"}}"&gt;&lt;/script&gt;
        &lt;script src="{{asset "js/jquery.swiftype.search.js"}}"&gt;&lt;/script&gt;

        &lt;script type="text/javascript"&gt;
            $("#st-search-input").swiftype({
                engineKey: "XXXXXX"
            });
            $("#st-search-input").swiftypeSearch({
                engineKey: "XXXXXX",
                resultContainingElement: "#st-results-container"
            });
        &lt;/script&gt;
    {{/is}}
</code></pre>

<p>This will tell Ghost to only include the javascript on 'page' types.  Unfortunately at this point the API isn't robust enough to target a specific page, but this will save you a few HTTP requests on archives and posts.</p>

<h3 id="createasearchpage">Create a Search Page</h3>

<p>If you are intending to create a static search page and not to integrate search into your theme template then head to your Ghost dashboard and create a new post.  I titled mine "Search":</p>

<p><img src="https://iyware.com/content/images/2015/02/post-named-search-in-ghost.png" alt=""></p>

<p>Click on the 'settings' wheel and change the post into a static page.  You can also adjust the slug if you'd like.</p>

<p><img src="https://iyware.com/content/images/2015/02/adjusting-a-post-type-in-ghost.png" alt=""></p>

<p>If you want to provide information to your users you can add content to the page, for example I added all the tags I use on my blog.  There's no easy way to do this I just don't have many tags, if you want something more dynamic, I suggest you add it to your template.</p>

<p><img src="https://iyware.com/content/images/2015/02/edited-search-page-with-content.png" alt=""></p>

<p>Finally it's time to add the search form to your page.  Even though Ghost uses Markdown, remember that any HTML is valid Markdown, so you can directly create a form:</p>

<pre><code class="language-markdown">&lt;form&gt;  
    &lt;input type="text" id="st-search-input"&gt;
    &lt;button type="submit"&gt;Search&lt;/button&gt;
&lt;/form&gt;

&lt;div id="st-results-container"&gt;&lt;/div&gt;  
</code></pre>

<p>Publish your page and you should be ready to go (assuming Swiftype has finished indexing your content).  Just make sure that the form ID and the results ID match your jQuery selectors- they should if you just copied from here.</p>

<p><img src="https://iyware.com/content/images/2015/02/swiftype-autocomplete.png" alt=""></p>

<p>That's it for the integration.  You can always go back and edit the CSS to better match your site.  You can also add the <a href="https://swiftype.com/engines/iyware-dot-com/install"><code>renderFunction</code></a> to your JavaScript to control how Swiftype outputs its results.</p>

<p>There you have it, you now have an indexed and searchable blog.</p>]]></description><link>https://iyware.com/add-search-to-your-ghost-blog/</link><guid isPermaLink="false">761b70ab-c126-4d8c-9b4c-3794af4bc8c9</guid><category><![CDATA[Ghost]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Mon, 02 Feb 2015 05:39:55 GMT</pubDate></item><item><title><![CDATA[Don't Use .dev For Development]]></title><description><![CDATA[<p>A while back I wrote about setting up <a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">DNSMasq</a> for your local development using the <code>.localhost</code> <a href="http://en.wikipedia.org/wiki/Top-level_domain">TLD</a>.  Unfortunately during my research I came across a lot of people advocating setup using the hypothetical <code>.dev</code> domain under the guise of "DevOps".  I hate to say it but this is a bad idea, so consider this post a public service announcement.</p>

<h2 id="generictlds">Generic TLDs</h2>

<p>In the beginning there was <code>.com</code> and it was good.  In 1984 the IETF released <a href="http://tools.ietf.org/html/rfc920">RFC-920</a> which specified a list of generic top level domains including:</p>

<ul>
<li><code>.gov</code></li>
<li><code>.edu</code></li>
<li><code>.com</code></li>
<li><code>.mil</code></li>
<li><code>.org</code></li>
<li><code>.net</code> (added later)</li>
</ul>

<p>in addition to country code TLDs.  We're probably all familiar with these as they have been the primary domains since then, and upto even a few years ago it would have been safe to mess around with other top-level domains on your local DNS or intranet.  But the issue now is that the IANA has started registering <a href="https://www.iana.org/domains/root/db">more and more</a> TLDs.</p>

<p>Do you remember how pissed you were (or your sysadmin was) when your intranet was set to the same domain as your company website and no one could reach the website because your AD server was serving an IIS error page?  I do.  Everyone that's advocating using <code>.dev</code> is potentially doing the same thing.</p>

<h2 id="newhotnesswhatever">New hotness: .whatever</h2>

<p>According to <a href="http://www.gtld.com/">gTLD.com</a>:</p>

<blockquote>
  <p>The release of more than 1,000 new gTLDs (generic Top Level Domains) is the biggest shake-up since the internet began.</p>
  
  <p>Dot place, dot trend, dot industry, dot meme – dot allsorts. They’re up for grabs.</p>
</blockquote>

<p>You read that right, we went from a list of 6 TLDs to over 1,000 [vegeta-its-over-1000.gif]!  Why?</p>

<blockquote>
  <p>One of ICANN's key commitments is to promote competition in the domain name market</p>
</blockquote>

<p><a href="http://newgtlds.icann.org/en/applicants/customer-service/faqs/faqs-en">Money</a>, duh.</p>

<h2 id="dontdowhatdonnydevdoes">Don't Do What Donny Dev Does</h2>

<p>Ok, that's all well and good but what about <code>.dev</code>?  Turns out it's <a href="https://www.iana.org/domains/root/db/dev.html">already available</a> as a TLD.  Oops.  Oh, look, it's administered by Google too- so you know it's super serious.  Now, I want you go to back to a DNSmasq article where the author advocates routing all <code>.dev</code> traffic to <code>127.0.0.1</code> and replace <code>.dev</code> with <code>.com</code> and then tell me how smart of an idea it is.  Awesome DevOps d00d!</p>

<h2 id="reservedtopleveldomainnames">Reserved Top Level Domain Names</h2>

<p>Now that I've dumped all over DNS hacking it's only fair that I suggest an alternative.  The answer is simple: <a href="http://tools.ietf.org/html/rfc2606">RFC-2606</a>.  You see after the IETF released the list of Generic TLDs they released a list of Reserved TLDs.  Reserved meaning that they will never be valid TLDs in a global DNS sense.  This is similar to how <code>192.xxx.xxx.xxx</code> and <code>10.xxx.xxx.xxx</code> are reserved IP addresses.</p>

<p>The list of Reserved TLDs contains 4 different domains specifically for "Testing &amp; Documentation Examples":</p>

<ul>
<li><code>.test</code></li>
<li><code>.example</code></li>
<li><code>.invalid</code></li>
<li><code>.localhost</code></li>
</ul>

<p>A subsection of the document also declares reserved second-level addresses:</p>

<ul>
<li><code>example.com</code></li>
<li><code>example.net</code></li>
<li><code>example.org</code></li>
</ul>

<p>so feel free to continue to use <code>nobody@example.com</code> for instructions for users.</p>

<h2 id="usingreservedtlds">Using Reserved TLDs</h2>

<p>RFC-2606 goes on to describe recommended usage cases for the four reserved TLDs but they're pretty vague, saying things like:</p>

<blockquote>
  <p>".invalid" is intended for use in online construction of domain names that are sure to be invalid and which it is obvious at a glance are invalid.</p>
</blockquote>

<p>In order to clarify when and how these Reserved TLDs should be used another specification was released, <a href="http://tools.ietf.org/html/rfc6761">RFC-6761</a>: Special-Use Domain Names.  This document clarifies how a Reserved TLD should be used and how it should be handled by DNS servers.  This document specifies seven categories of use: </p>

<ol>
<li>users</li>
<li>applications</li>
<li>APIs &amp; libraries</li>
<li>DNS cache servers</li>
<li>Authoratative DNS servers</li>
<li>DNS server operators</li>
<li>DNS registries/registrars</li>
</ol>

<p>Probably as a developer you only care about the first 4, and maybe number 5, essentially, how does your local network handle these domains?  Go read the specification and the outline for each Reserved TLD.</p>

<h2 id="recommendedsetup">Recommended Setup</h2>

<p>Now I'll outline my recommendation to you for using the Reserved TLDs.  There's a bit of wiggle room in here, by design of the RFCs.</p>

<h3 id="localhosttld">.localhost TLD</h3>

<p>I recommend (as does RFC-6761) that you use <code>.localhost</code> to only look at your local loopback address: <code>127.0.0.1</code>. The specification explicitly states that APIs and libraries <em>should</em> point at the loopback address already, so if you were to try to point it anywhere else you might end up with unexpected results.  In addition everyone knows that <code>localhost === 127.0.0.1</code> so from a people perspective, this just makes sense.</p>

<h3 id="invalidtld">.invalid TLD</h3>

<p>This is just my personal recommendation, but it is acceptable according to the specification.  Your local DNS cache server should be configured to point <code>.invalid</code> domains back to development machines. This should NOT be configured on a client machine.  If you're using static IPs or DHCP reservations (better, IMO) then you can easily set this up.</p>

<p>The reason for this is that you can serve the same site (hopefully) from <code>.localhost</code> or <code>.invalid</code>.  If you have a cool new feature that you want to show someone or want someone to play with then they can view it- but they know that it requires your dev machine to be up and running.  This is great for face-to-face development.  Here's an example:</p>

<p>I spend a while working on <code>dannywahlmbp.localhost/widget</code> and I want some feedback.  I send a coworker a link to <code>dannywahlmbp.invalid/widget</code> and we can sit down and check it out together.  If I shut my laptop- it's gone.  This isn't necessarily obvious in the naming but it can be documented.</p>

<h3 id="testexampletlds">.test &amp; .example TLDs</h3>

<p>You could decide to use either of these interchangably but I recommend using <code>.test</code> first.  My recommendation is that <code>.test</code> is where you move code to be tested- this is the first step toward production.  So my code base would be moved off of my development machine and onto a server that's accessible by all machines on our local network 24/7.  Maybe you start running code coverage here- maybe it's even an upstream repository.  Of course you'll need to configure your local DNS server.</p>

<p>The final step is to use <code>.example</code>.  My recommendation is that you use this for code that's nearly ready to go live.  You could also use this to tie together multiple locations and even use an internet-facing IP address, knowing that it's not going to be resolved by global DNS servers.</p>

<p>After that you're ready to go live with trusty ol' <code>.com</code>.  Hacking on domains and DNS can be fun and a lot of people have built some really cool tools- but it's important that you use them appropriately too.  Once <code>.dev</code> domains start becoming prevalent I imagine that there will be a few people kicking themselves for mapping it to their local machine, but hey, that's part of learning!</p>]]></description><link>https://iyware.com/dont-use-dev-for-development/</link><guid isPermaLink="false">b3eb1e13-08a6-4a51-bd5e-ee5aae947505</guid><category><![CDATA[DevOps]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Tue, 27 Jan 2015 02:39:52 GMT</pubDate></item><item><title><![CDATA[Migrate from WordPress to Ghost]]></title><description><![CDATA[<p>I've been using <a href="http://wordpress.org/">WordPress</a> as the backend of my website for about 4 years now.  I've been a fan of its simplicity, its usability, and its extensability.  I didn't want to spend a lot of time developing a site- I just wanted to blog but as time went on my site was hacked, hacked again, botched an upgrade, received 20,000+ spam comments, and I realized I was spending more time as a WordPress administrator than as a WordPress author.  In a nutshell I was tired of my WordPress backend looking like this:</p>

<p><img src="https://iyware.com/content/images/2015/01/picture-of-an-ugly-wp-dashboard.png" alt=""></p>

<p>So in my usual fashion I decided to pick something new that I knew nothing about and dive into that.  I picked <a href="http://ghost.org/">Ghost</a> because at its core it's what I wanted; a blogging platform.  Sure it's young, sure it's missing some features I want (or at least I thought I did until I actually started migrating) but that's OK with me.  It's extremely functional as a blog.</p>

<p>In this post I will detail how I migrated, and how you can migrate too, from WordPress to Ghost.  I'm going to assume that you have a copy of Ghost already up an running <em>somewhere</em>.  I did mine on my MacBook but you could have a host somewhere too, however, if that's the case, you'll probably need FTP access at some point.</p>

<h2 id="exportyourwordpresscontent">Export Your WordPress Content</h2>

<p>There is quite a list of things that need to be exported from WordPress if you want to do a full site migration which may include:</p>

<ul>
<li>Comments</li>
<li>Uploads (images, .zip, text files, etc...)</li>
<li>Users</li>
<li>Posts</li>
<li>Pages</li>
<li>Tags <del>and Categories</del></li>
</ul>

<p>At the time of this writing Ghost doesn't support categories, so we're not going to bother with attempting to <em>add</em> functionality.  If you want categories, please read the <a href="https://github.com/TryGhost/Ghost/wiki/Tags-101#canonical--primary">Ghost documentation on the subject</a> first and then try <a href="http://www.mathachew.com/blog/add-a-category-to-your-posts-url-in-ghost/">this hack</a> or make sure that your WordPress post category is also a tag.</p>

<h3 id="exportyourwordpresscomments">Export Your WordPress Comments</h3>

<p>The first thing to do is export your WordPress comments.  Unfortunately at the time of this writing Ghost does not support native comments, but there are many commenting solutions available that can be easily integrated with Ghost.  For this tutorial we will be using <a href="https://disqus.com/">Disqus</a> to host our comments.</p>

<h4 id="installdisquswpplugin">Install Disqus WP Plugin</h4>

<p>There is a plugin available from the WordPress plugins page called "<a href="https://wordpress.org/plugins/disqus-comment-system/">Disqus Comment System</a>" that needs to be installed.  This is the official Disqus plugin for WordPress and as such it works pretty well.  Simply install and activate the plugin.</p>

<p><img src="https://iyware.com/content/images/2015/01/activated-disqus-comments-plugin.png" alt=""></p>

<h4 id="addadisqussite">Add a Disqus Site</h4>

<p>If you don't already have a Disqus account <a href="https://disqus.com/admin/signup/?utm_source=New-Site">sign up</a> for one, if you do have an account sign in and click on "<a href="https://disqus.com/admin/create/">Add Disqus to Your Site</a>".</p>

<p>Fill out the 3 fields on the form with the information for your site and click "Finish Registration".  For example my site name is just 'iyWare' and the URL is 'iyware.disqus.com'.  However, if you have a marketing identity or branding guideline, follow that.  Frankly I'm not sure how many people stumble up a blog by navigating the Disqus homepage so your conversion based on this information alone will probably be pretty low.</p>

<p><img src="https://iyware.com/content/images/2015/01/signing-up-for-a-disqus-site.png" alt=""></p>

<p>After you click "Finish Registration" you will be taken to the "Install" page under "Settings".  Since we've installed the Disqus plugin on WordPress we don't need to do a separate installation.  But we will need to come back to this page to get the "Universal Code" (a.k.a. JavaScript) when it's time to install it in Ghost.</p>

<p><img src="https://iyware.com/content/images/2015/01/disqus-installation-options.png" alt=""></p>

<h4 id="migratecommentstodisqus">Migrate Comments to Disqus</h4>

<p>Head back to your WordPress Dashboard and navigate to Comments in the sidebar. If you have any spam comments you'll want to delete those so that they don't accidentally get imported into Disqus.  This shouldn't happen, but I had a few get in there.</p>

<p><img src="https://iyware.com/content/images/2015/01/its-wonderful-spam.png" alt=""></p>

<p>Now click on Comments &rarr; Disqus in the sidebar.  If your site was has not been configured yet you will need to authenticate to Disqus and type in your site's identifier, which is the "Unique Disqus URL" that you chose earlier.</p>

<p>Once you've authenticated you can scroll down to the section titled "Import and Export" and find the label "Export Comments to Disqus".  Click the "Export Comments" button.</p>

<p><img src="https://iyware.com/content/images/2015/01/export-comments-to-disqus-section.png" alt=""></p>

<p>Shortly you should get an email from Disqus saying that comment migration has begun.</p>

<p><img src="https://iyware.com/content/images/2015/01/email-saying-disqus-import-began.png" alt=""></p>

<p>The linked site will show you the progress and tell you that it might take up to 24 hours to complete.  My site only too 3 or 4 hours, but I don't have too many comments (maybe 100?).  </p>

<h4 id="deletecommentsfromwp">Delete comments from WP</h4>

<p>After your comments are fully migrated to Disqus go back to WordPress &rarr; Comments &rarr; All Comments and delete all comments on your site.  Please don't delete your comments before the export is done (this should be obvious).  At this point I should mention that you might want to backup your WP DB first ;)</p>

<p>The reason we're going to delete the comments from the WordPress instance is because even though Ghost doesn't support comments yet the Ghost WordPress export tool DOES export your comments in its JSON file. So despite the fact that the documentation says</p>

<blockquote>
  <p>Ghost does not, and will not deal with comments.</p>
</blockquote>

<p>the Ghost exporter DOES export the comments.  Since I had over 1,800 spam comments they all got added to the JSON file and caused a real headache later- just to be ignored by Ghost.  So do yourself a favor, and delete the comments.</p>

<p><img src="https://iyware.com/content/images/2015/01/all-wordpress-comments-deleted.png" alt=""></p>

<p>After this you might want to temporarily disable commenting on your WordPress site or fully integrate Disqus because if people continue adding comments to WP after you've done the migration, they will be lost when you kick over to Ghost.</p>

<p>Finally you can head to your Disqus dashboard and view your site's comments there.</p>

<p><img src="https://iyware.com/content/images/2015/01/disqus-moderation-dashboard.png" alt=""></p>

<h3 id="exportyourwordpressmediauploads">Export Your WordPress Media (Uploads)</h3>

<p>According to the Ghost documentation</p>

<blockquote>
  <p>Ghost has very rudimentary media handling at the moment, and currently grabbing images from WordPress and plucking them into Ghost is tedious. For that reason it might be a good idea to sign up for a free Cloudinary account...</p>
</blockquote>

<p>However, migrating your media (anything you've uploaded to WordPress) is not actualy that difficult of a task and there are many good reasons to not host your images on another cloud account.</p>

<p>The reason that they advocate this is because the cloudinary plugin will transfer all your files to their server and then rewrite the URLs in your wordpress database so, for example</p>

<p><code>http://www.example.com/assets/coolimage.gif</code></p>

<p>would get rewritten as</p>

<p><code>http://couldinary.com/youraccount/coolimage.gif</code></p>

<p>which Ghost would have no trouble with when it is running as example.com instead of WordPress.  But it's very very simple to continue to serve your images directly from Ghost.</p>

<h4 id="findyourwordpressmediafiles">Find Your WordPress Media Files</h4>

<p>In WordPress head to Settings &rarr; Media and scroll down until you find the "Uploading Files" Section.  Take note of where your files are uploaded to.</p>

<p>It does not matter if you have "Organize my uploads into month- and year-based folders" checked or not.  However, IF you do have it enabled you will be able to get even richer Ghost integration.  If you don't please don't change it- as this will only affect new media files.</p>

<p><img src="https://iyware.com/content/images/2015/01/wordpress-multimedia-settings.png" alt=""></p>

<h4 id="downloadyourwordpressmediafiles">Download Your WordPress Media Files</h4>

<p>Once you know where the files are open up your FTP client and download the entire containing folder.  So in the example above I would be downloading <code>/assets/</code> folder.  If yours is the default you will be downling the <code>/uploads/</code> folder NOT <code>/wp-content/</code>.  If you accidentally download <code>/wp-content/</code> it's OK- we'll just pull <code>/uploads/</code> from inside of it later.</p>

<p><img src="https://iyware.com/content/images/2015/01/ftp-down-all-wordpress-uploads.png" alt=""></p>

<p>If you don't know your FTP credentials you'll need to check with your hosting provider about how to access.  If you don't have FTP you could try using the "<a href="https://wordpress.org/plugins/downml/">downML</a>" WordPress plugin to download your media library directly from WordPress.  I haven't personally tried this plugin.</p>

<h4 id="optionallyoptimizeyourfiles">Optionally Optimize Your Files</h4>

<p>This isn't a necessary step, but since Ghost doesn't have rich multimedia handling you could take this opportunity to properly minimize all of your media.  I simply dragged the entire <code>assets</code> folder that I downloaded onto the <a href="https://imageoptim.com/">ImageOptim</a> application.</p>

<p><img src="https://iyware.com/content/images/2015/01/image-optimization-in-progress.png" alt=""></p>

<p>You might notice that for every file uploaded to WordPress, e.g. "1.png" there are multiple versions in the media folder.  This is because the way WordPress works is to create multiple sizes of each image and store them on the server, which you can then insert into a post/page/whatever.  Ghost will only use one version but it doesn't hurt to have them all there- it will only use more disk space, not more bandwidth.</p>

<p>After the image compression finishes you'll probably find it's quite worth it.  I was able to shave 35.8MB off of 138.7MB for a total of 29.9%.  Not too shabby.</p>

<p>If you want to further optimize your images you could batch resize them to the max-width that you theme will output.  I don't necessarily recommend this as you might want a header image or change themes at some point in the future.  Not too mention that a user could still want to see the image at full size which simply isn't possible if you've manually resized it.</p>

<h4 id="moveyourwordpressmediatoghost">Move Your WordPress Media to Ghost</h4>

<p>WordPress will store your images by default in the relative path <code>/wp-content/uploads/</code> and if you've enabled year and month sorting then it will add <code>YYYY/MM/</code> to the path.</p>

<p>Ghost will store your images by default in <code>/content/images/YYYY/MM/</code> which is a similar URL structure.</p>

<p>Now you can take your WordPress uploads folder and just drop it into the <code>/ghost/content/images/</code> folder on your install.  You can see that I renamed mine to "import" (which might not have been the best idea) but if an image failed I wanted to know it was from WordPress.</p>

<p><img src="https://iyware.com/content/images/2015/01/wp-content-in-ghost-content.png" alt=""></p>

<p>If you were using year and month folders in WordPress then you can merge the folder with the Ghost folder for a completely seamless migration.  However, since I haven't tested this You might need to be careful for name collisions when adding media in the future.  This should NOT be an issue because importing our WordPress post content (covered later) <em>should</em> add the media references to the sqlite database.</p>

<p>For my site any posts imported from WordPress will serve images from <code>/content/images/import/image.png</code> and any new posts created in Ghost will serve from <code>/content/images/YYYY/MM/image.png</code> with no ill effect.</p>

<p>We'll still have a little more work to do to point the post data to the new URL but that will be covered later on.  For now your physical assets are located in Ghost.  You can test this by creating a new post in Ghost, inserting an image, and pointing the path to an imported image:</p>

<p><img src="https://iyware.com/content/images/2015/01/wordpress-image-imported-into-ghost-1.png" alt=""></p>

<h3 id="exportyourwordpressdata">Export Your WordPress Data</h3>

<p>Now that we've taken care of comments and media it's time to move on to actual WordPress data.  There are quite a few steps to this process but they are all fairly simple.</p>

<h4 id="publishyourwordpressdrafts">Publish Your WordPress Drafts</h4>

<p>I recommend that if you have any WordPress drafts that you publish them.  The Ghost Export tool should handle them, but it definitely handles published materials.  You can always unpublish once your content is imported into Ghost.</p>

<h4 id="deleteyourwordpresstrash">Delete Your WordPress Trash</h4>

<p>If you have any trash on WordPress, delete it.  This includes Posts, Pages, Comments, etc... If you don't want it then you definitely don't want it to migrate.  For now less is more.  If You have a backup of your DB you can always go back and get it later.</p>

<h4 id="convertyourwordpressposttypes">Convert Your WordPress Post Types</h4>

<p>One of the most popular features in WordPress is custom post types like "Portfolio", "Gallery", or whatever.  However, Ghost only supports two types- which are the default WordPress types- "Post" and "Page".  The Ghost Exporter might export other types but it won't know how to map them, so you'll need to do it manually.</p>

<p>The "<a href="https://wordpress.org/plugins/post-type-switcher/">Post Type Switcher</a>" WordPress plugin is a great utility for switching individual posts.  To change a post type after you have installed this plugin simply go to edit the post (page, or whatever) and click "Edit" under the "Post Type" section in the "Publish" widget, choose Post or Page, and click "Update".</p>

<p><img src="https://iyware.com/content/images/2015/01/post-type-switcher-example.png" alt=""></p>

<p>If You have a lot of posts to convert you might consider using the "<a href="https://wordpress.org/plugins/convert-post-types/">Convert Post Types</a>" plugin instead.  I have not personally used this plugin.</p>

<h4 id="addwordpresscategoriesastags">Add WordPress Categories as Tags</h4>

<p>As we mentioned earlier, Ghost does not support Categories- only tags.  As a result when we export WordPress data later categories will be lost.  If you wish to preserve a category-like metadata in your post you must add the category as a tag in your WordPress posts.</p>

<p><img src="https://iyware.com/content/images/2015/01/category-not-a-tag.png" alt=""></p>

<p>In this example the category "Android" will not be preserved when exporting to Ghost.  I need to manually add the category as a tag.</p>

<p><img src="https://iyware.com/content/images/2015/01/category-and-tag.png" alt=""></p>

<p>Now when I export my WordPress data the tag "Android" will still be associated with this post.  At the time of this writing Ghost 0.5.8 has only rudimentary tag support, so you can't set "Android" as the first or primary tag or anything like that- tags are simply all listed alphabetically.</p>

<p>If you have many posts I suggest using the WordPress plugin "<a href="https://wordpress.org/plugins/wpcat2tag-importer/">Categories to Tags Converter</a>" which will automate this process for you.  I have not personally used this plugin.</p>

<h4 id="deleteyourwordpressusers">Delete Your WordPress Users</h4>

<p>The Ghost export plugin will export all users and associated metadata, so if you have "Anyone can register" enabled under Settings &rarr; General in your WordPress instance you will need to check your users page to see how many users you have.</p>

<p><img src="https://iyware.com/content/images/2015/01/anyone-can-register-is-enabled.png" alt=""></p>

<p>Navigate to Users &rarr; All Users and see how many users are registered on your site.  My site had over 18,000 users registered with the default role "Subscriber".  If you don't have too many users you can filter the role and delete them.</p>

<p><img src="https://iyware.com/content/images/2015/01/picture-of-too-many-wp-subscribers.png" alt=""></p>

<p>However, if you have more than a few hundred users it will be more effective to delete the users directly from the database.  You can connect to phpMyAdmin or directly to your database and execute the following SQL commands.</p>

<pre><code class="language-sql">DELETE  
FROM wp_users  
WHERE ID NOT IN  
(SELECT post_author FROM wp_posts
UNION SELECT user_id FROM wp_comments);

DELETE  
FROM wp_usermeta  
WHERE user_id NOT IN  
(SELECT ID FROM wp_users);
</code></pre>

<p><em>commands courtsey of <a href="http://wordpress.mcdspot.com/">vtxyzzy</a> at <a href="https://wordpress.org/support/topic/best-way-to-delete-users?replies=8#post-1838411">WordPress Support Forums</a></em></p>

<p>This will execute two commands, the first will delete all users from the <code>wp_users</code> table who are not post authors.  <strong>Caveat</strong>: if you have an admin account that you use to change settings and a separate account to post with you WILL lose your admin account.  Quickly publish something with your admin account or modify the SQL command.</p>

<p>The second command will delete the metadata for users from the <code>wp_metadata</code> table for users that aren't found in the <code>wp_users</code> table.</p>

<p>Again, please make sure you have a backup of your database first.  After you execute the SQL commands you can refresh the All Users page on WordPress and only post authors should be left- in my case just my account.</p>

<p><img src="https://iyware.com/content/images/2015/01/all-extra-wp-users-deleted.png" alt=""></p>

<h4 id="installwordpressghostexporter">Install WordPress Ghost Exporter</h4>

<p>I've mentioned exporting your WordPress data to Ghost a few times so far and now we're going to get ready to do just that.  The final WordPress plugin you'll need to install is the oddly named "<a href="https://wordpress.org/plugins/ghost/">Ghost</a>" which takes all of WordPress data, and converts it to a format that can be imported to your Ghost instance.  Once you've installed and activated the plugin head to Tools &rarr; Export to Ghost in WordPress.</p>

<p><img src="https://iyware.com/content/images/2015/01/export-to-ghost-page.png" alt=""></p>

<h4 id="exportyourghostjsonfile">Export Your Ghost JSON File</h4>

<p>Now that the Ghost exporter is installed and activated it's time to actually export the data.  You can safely ignore the "Things to Keep in Mind" section as it mostly covers things that we've gone over in this post.  Scroll to the bottom of the page and click "Download Ghost File"</p>

<p>WordPress will think for a minute and you should eventually get a download prompt for a .json file</p>

<p><img src="https://iyware.com/content/images/2015/01/download-wp2ghost-json-file.png" alt=""></p>

<p>Save the file to your local machine and you're done with WordPress for now.</p>

<h5 id="fixghostjsonexporterrors">Fix Ghost JSON Export Errors</h5>

<p>The potential for something going wrong is pretty high at this point.  There's a lot of data manipulation and conversion going on and the amount of variables from system to system can be pretty extreme.  Your best bet is to check the <a href="https://wordpress.org/support/plugin/ghost">WordPress to Ghost Support Forum</a> at WordPress and see if anyone else has had the same error as you.  If they haven't, report it there and see if someone can help you.  That said here are the errors I ran into.</p>

<h6 id="errorwhitepageofdeath">Error: White Page of Death</h6>

<p>After clicking "Download Ghost File" my WordPress just hung for a minute and turned to a white page.  I enabled debugging on my WordPress instance by editing my wp-config.php and changing</p>

<pre><code class="language-php">define( 'WP_DEBUG', false );  
</code></pre>

<p>to </p>

<pre><code class="language-php">define( 'WP_DEBUG', true );  
</code></pre>

<p>After enabling debugging I ran the export again and the page output the error:</p>

<p><code>Fatal error: Maximum execution time of 30 seconds exceeded</code></p>

<p>Essentially, it was taking the exporter longer to build the download file than my server was set to allow.  Fortunately this is something that can be easily changed in a variety of ways:</p>

<ul>
<li><a href="http://php.net/manual/en/info.configuration.php#ini.max-execution-time">php.ini</a></li>
<li><a href="http://php.net/manual/en/info.configuration.php#ini.max-execution-time">phprc</a></li>
<li><a href="http://stackoverflow.com/questions/7739870/increase-max-execution-time-for-php">.htaccess</a></li>
<li><a href="http://stackoverflow.com/questions/14681655/how-can-i-override-the-php-ini-value-of-max-execution-time-at-runtime">script level</a></li>
</ul>

<p>I ended up settling on the script level so that it only changed it for this export tool.  To do this, in WordPress head to Plugins &rarr; Editor and choose "Ghost" from the menu on the top right then select the file <code>ghost/class-ghost.php</code>.  </p>

<p><img src="https://iyware.com/content/images/2015/01/editing-a-plugin-in-wordpress.png" alt=""></p>

<p>Search the file for the definition of the function <code>populate_data()</code> at the begging of the function add an <code>ini_set()</code>.  Your code should now look like this:</p>

<pre><code class="language-php">    /**
     * Gets the raw data in an array that will be later turned into glorious escaped json format
     * so Ghost can gobble it up
     * @return array                        everything we need, but in an array
     */
    public function populate_data() {
            ini_set('max_execution_time', 0);
        if ( $this-&gt;garray !== null ) {
            return;
        }

        $this-&gt;_safe_url( 'http://google.com' );

        $this-&gt;garray = array();

        // preps the structure
        $this-&gt;prepare_garray_structure();

        // attaches metadata
        $this-&gt;populate_meta();

        // get the users
        $this-&gt;populate_users();

        // attaches tags
        $this-&gt;populate_tags();

        // populates posts
        $this-&gt;populate_posts();
    }
</code></pre>

<p>setting the value of <code>max_execution_time</code> to <code>0</code> means 'unlimited'.  Now you might run into a memory error, but similarly you can allocate extra memory.</p>

<h6 id="errorinvalidcontentencoding">Error: Invalid Content Encoding</h6>

<p>After I was able to extend the execution time I started getting an "Invalid Content Encoding" error when trying to generate the file.  It would gripe about being unable to set headers after they'd already been set.  The specific code it was referring to was again in class-ghost.php</p>

<pre><code class="language-php">        header( 'Content-Description: File Transfer' );
        header( 'Content-Type: application/octet-stream' );
        header( 'Content-Disposition: attachment; filename='.$filename );
        header( 'Content-Transfer-Encoding: binary' );
        header( 'Expires: 0' );
        header( 'Cache-Control: must-revalidate' );
        header( 'Pragma: public' );
        header( 'Content-Length: ' . filesize( $filedir . '/' . $filename ) );
</code></pre>

<p>Here ghost is trying to build and serve the download file, not a webpage, but what I discovered was that with debugging on PHP would throw  an error</p>

<pre><code class="language-php">Notice: Undefined index: description in /wp-content/plugins/ghost/class-ghost.php on line 394  
</code></pre>

<p>saying that it couldn't grab some data from WordPress.  When PHP threw the error it would set the headers to a webpage to display the error, then Ghost Export would try to set them to be a file download, and we'd end up with a content encoding error.</p>

<p>There are a couple of ways to fix this.  The first (and easiest) is to disable debugging.  This will prevent PHP from throwing a notice, that value will silently fail (not a problem) and you'll get your export file.  The second is to comment out the link looking for the <code>description</code> index so the failure doesn't occur.  You still don't end up with the data but it's not a big deal.  Again in class-ghost.php edit the <code>user_meta</code> section to comment out <code>bio</code> as shown below:</p>

<pre><code class="language-php">        foreach ( $users as $user ) {
            $user_meta = get_user_meta( $user-&gt;ID );

            $this-&gt;garray['data']['users'][] = array(
                'id' =&gt; $this-&gt;_safe_author_id( $user-&gt;ID ),
                'slug' =&gt; $user-&gt;user_login,
                //'bio' =&gt; substr( $user_meta['description'][0], 0, 199 ),
                'website' =&gt; $this-&gt;_safe_url( $user-&gt;user_url ),
                'created_at' =&gt; $this-&gt;_get_json_date( $user-&gt;user_registered ),
                'created_by' =&gt; 1,
                'email' =&gt; $user-&gt;user_email,
                'name' =&gt; $user-&gt;user_nicename,
            );
        }
</code></pre>

<h6 id="error404pagenotfound">Error: 404 Page Not Found</h6>

<p>Occassionally you will end up at a page that was served by the WordPress front end instead of getting your JSON file or an error.  This is, I believe (though I haven't investigated) related to the script execution time and memory limit.  Increasing those as described above should resolve it.</p>

<h6 id="errorcorruptjsonfile">Error: Corrupt JSON File</h6>

<p>You won't necessarily know that you have a corrupt file until you go to import it and it fails.  But a fast way to check if your download file is vaild is to either open it in a text editor and check, or pass it to a website like <a href="http://jsonlint.com/">JSONLint</a>.  A corrupt file would look something like this:</p>

<p><img src="https://iyware.com/content/images/2015/01/botched-JSON-export.png" alt=""></p>

<p>If you look closesly you can see that where it falls apart is actually on a user account.  When I first tried to export my WP data to JSON the file size was over 4MB.  4MB of text is quite a lot of data.  After removing comments, users, drafts, etc... the final file size was 498Kb.  So if you're getting a botched JSON file please make sure that you've followed this tutorial so far- otherwise investigate where it's failing and if you can't fix it submit a report at the <a href="https://wordpress.org/support/plugin/ghost">WordPress Support Forums for Ghost</a>.</p>

<h2 id="manipulateyourwordpressdata">Manipulate Your WordPress Data</h2>

<p>If you follow the import instructions of the Ghost plugin you would simply import your JSON file into Ghost, but if you do that now you'll spend more time correcting data in Ghost than you need to.  We're simply going to massage the data to be a better fit in Ghost.</p>

<h3 id="removewordpressshortcodes">Remove WordPress Shortcodes</h3>

<p>One of the major drawbacks of WordPress is shortcodes.  Years ago they were revolutionary, <code>[gallery]</code> was awesome!  But once theme devs started adding their own shortcodes to create a type of "vendor lock-in" then they got really frustrating.</p>

<p>So Hopefully you didn't have any shortcodes in your text.  I did.  When you import them into ghost the raw code will show up.  For example, if you had a shortcode called <code>[button]</code> that outputs a link element with the class button, in Ghost you'll just have:</p>

<pre><code class="language-markup">[button href="#"]Text[/button]
</code></pre>

<p>Which probably you just don't want.  Now, fortunately shortcodes are just a bit of code that become a different bit of code which means we can reverse engineer them pretty easily.  Open your JSON file in your favorite text editor, I'm using <a href="http://panic.com/coda/">Coda 2</a> but you can use <a href="http://ss64.com/bash/sed.html">sed</a> or whatever you want.</p>

<p>You're going to have to do a little bit of personalization here but I'll give you an overview of what I did in my editor.</p>

<p><strong>Note:</strong> be sure to escape your <a href="http://json.org/">JSON strings</a>!</p>

<h4 id="replacebuttonshortcode">Replace [button] Shortcode</h4>

<p>In My text editor I simply searched for <code>[button</code> (not there's no closing bracket) to evaluate how I used it in my source and then built a replacement string:</p>

<pre><code class="language-javascript">[button link=\u201d
&lt;a href=\"

\u201d]Download[\/button]
\"&gt;Download&lt;\/a&gt;
</code></pre>

<h4 id="replacetabgroupshortcode">Replace [tabgroup] Shortcode</h4>

<p>The second shortcode I used was was one that took some inline code and formatted it for jQuery tabs.  Mostly all I needed to do to replace them was a NULL string</p>

<pre><code class="language-javascript">[tabgroup]
NULL

[tab]
NULL

[\/tab]
NULL

[\/tabgroup]
NULL  
</code></pre>

<p>The output was simply the inline markup.</p>

<h3 id="editwordpressurls">Edit WordPress URLs</h3>

<p>After the shortcodes we need to edit wordpress URLs to work with our Ghost paths.  Remember that our media has been moved from <code>/wp-content/uploads/</code> (default) or <code>/assets/</code> to <code>/content/images/</code>.  Since the paths have moved we need to reflect this in our posts.  Again we simply use find and replace.  This time we need 3 find and replaces starting with fully qualified path down to relative path.  The reason being that if you replace the relative path first then the fully qualified path will fail.</p>

<p>My site was served from <code>http://www.iyware.com</code> so we'll start with <code>http://www.iyware.com/assets/</code> again we need to escape the JSON strings.</p>

<pre><code class="language-javascript">http:\/\/www.iyware.com\/assets\/  
\/content\/images\/import\/

http:\/\/iyware.com\/assets\/  
\/content\/images\/import\/

\/assets\/
\/content\/images\/import\/
</code></pre>

<p>In addition to images/videos this will work for ALL media, so if you have text, html, or zip files they will work too.  This again, in my opinion, makes it a better option than migrating your images to cloudify.</p>

<h3 id="optionallyeditwordpressmediaurls">Optionally Edit WordPress Media URLs</h3>

<p>Once we've rewritten the paths for our media to be relative to our Ghost instance we need to edit the source for our images to always use the original image.  Go back to your WordPress instance and note the thumbnail sizes for images under Settings &rarr; Media.</p>

<p><img src="https://iyware.com/content/images/2015/01/wordpress-image-sizes.png" alt=""></p>

<p>When you insert an image into a WordPress post you generally have to choose an image size and WordPress will insert the resized image with the dimensions appended to it inside of an anchor element linked to the original.  So, for example an image called "post.jpg" that was inserted into a WordPress post at medium size (using the settings above) would generate the following HTML:</p>

<pre><code class="language-markup">&lt;a href="/wp-content/uploads/post.jpg"&gt;  
  &lt;img src="/wp-content/uploads/post-500x500.jpg" /&gt;
&lt;/a&gt;  
</code></pre>

<p>Essentially all we need to do is strip off the suffix for each media size.  Make sure that you use your WordPress settings, and if you've ever changed the settings that you use what your old settings were too.</p>

<pre><code class="language-javascript">-300x300
NULL

-500x500
NULL

-960x658
NULL  
</code></pre>

<p>Now the output HTML would look like this:</p>

<pre><code class="language-markup">&lt;a href="/wp-content/uploads/post.jpg"&gt;  
  &lt;img src="/wp-content/uploads/post.jpg" /&gt;
&lt;/a&gt;  
</code></pre>

<h2 id="importyourwordpressdatatoghost">Import Your WordPress Data to Ghost</h2>

<p>Now that our JSON file has been edited to better work with it's ready to be imported to Ghost.  Fortunately this is about the easiest part of the process.  On your Ghost instance head to Settings &rarr; Labs &rarr; Import.</p>

<p><img src="https://iyware.com/content/images/2015/01/ghost-labs-import.png" alt=""></p>

<p>Click "Browse" and then select your edited JSON file and click "Import".  When the import is finished you should be able to browse your posts on the back-end and the front-end with working images and links to other media resources (.zip, .html, etc...).</p>

<h2 id="integratedisquscommentswithghost">Integrate Disqus Comments with Ghost</h2>

<p>Now that all the other data has been imported the only thing left to do is add comments back to the site.  Since Ghost doesn't natively support comments we won't be importing them from Disqus, but rather integrating the Disqus JavaScript applet into our theme template.</p>

<h3 id="configuredisqussettings">Configure Disqus settings</h3>

<p>Before we integrate the code there are a couple of settings worth checking at the Disqus website.  In the Disqus Admin Panel click on the "settings" tab and scroll to "Community Settings".</p>

<p><img src="https://iyware.com/content/images/2015/01/disqus-community-settings.png" alt=""></p>

<p>It's worth reviewing some of the settings regarding moderation and guest posting.  I personally enabled guest posting as I don't necessarily expect someone to sign up for an account at a third party website to comment on my site.</p>

<h3 id="insertdisqusjavascriptcode">Insert Disqus JavaScript Code</h3>

<p>Now you can integrate the Disqus code into your site.  The Ghost documentation has a great overview of doing that:  "<a href="http://support.ghost.org/add-disqus-to-my-ghost-blog/">How Do I Add Disqus to my Ghost Blog?</a>"</p>

<p>I highly recommend that you simply follow that tutorial and then return here- no need to reinvent the wheel!</p>

<p>Once you have completed that I do have one change that I make to the integration to increase user experience.  In your <code>post.hbs</code> where you inserted the Disqus JavaScript find this line:</p>

<pre><code class="language-javascript"> &lt;noscript&gt;Please enable JavaScript to view the &lt;a href="https://disqus.com/?ref_noscript"&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;
</code></pre>

<p>and replace it with a link to your site's Disqus forum instead of to the Disqus homepage.</p>

<pre><code class="language-markup">&lt;noscript&gt;Please enable JavaScript to view the &lt;a href="https://disqus.com/home/forums/iyware/"&gt;comments powered by Disqus.&lt;/a&gt;&lt;/noscript&gt;  
</code></pre>

<p>Obviously you'll need to replace <code>/iyware/</code> with your site's URL, but this will allow users with JavaScript disabled on your site to go directly to your Disqus forum- where they'll get another error if they hava JS disabled there too- but that's a Disqus problem, not yours.</p>

<h2 id="optionallymovewordpresstoanotherdomain">Optionally Move WordPress to Another Domain</h2>

<p>If you intend to run Ghost on the same domain as your WordPress instance was originally running you'll need to move your WordPress to a different domain.  Personally I moved my WordPress instance to the <code>old.</code> subdomain.  To do this you can simply head to Settings -> General in WordPress and change both "WordPress Address (URL) and "Site Address (URL)" to the new domain that you wish to use.</p>

<p><img src="https://iyware.com/content/images/2015/01/wordpress-settings-general.png" alt=""></p>

<p>Without doing a massive find and replace in your database a lot of things will probably break- like image URLs but the site will be largely functional.</p>

<p>Please note that as soon as you change this setting your WordPress site will stop serving at the old URL and only serve from the new URL so if you need to configure the submain with your DNS provider make sure to do that too.  I'm using CloudFlare for DNS so I simply added an "A Record" for "old" pointing to the IP address where WordPress is hosted.</p>

<p><img src="https://iyware.com/content/images/2015/01/redirect-to-old-wordpress.png" alt=""></p>

<p>If you've already published Ghost to your domain and lost access to WordPress you can change it in the database directly.  Here's an example of the two fields to change in phpMyAdmin but changing directly in SQL will work too.</p>

<p>Field <code>siteurl</code> in table <code>wp_options</code></p>

<p><img src="https://iyware.com/content/images/2015/01/edit-old-wordpress-database-siteurl.png" alt=""></p>

<p>Field <code>home</code> in table <code>wp_options</code></p>

<p><img src="https://iyware.com/content/images/2015/01/edit-old-wordpress-home.png" alt=""></p>

<h2 id="finalsteps">Final Steps</h2>

<p>Hopefully by this point all the heavy lifting is done.  If you're intending to setup Ghost as your main domain you can do do that as WordPress is now out of the way.</p>

<p>Of course I strongly recommend you do a thorough content audit before you go live.  It took me about a day and a half to audit my 60 or so posts and clean them up a little.  The biggest issue I found was that the MarkDown conversion stripped anything that came after two less-than signs (<code>&lt;&lt;</code>) for whatever reason.  Fortunately there were only two instances in my site where this happened and I was able to repace the text by copying it straight from WordPress to the Ghost editor.</p>

<p>The only other thing I did was remove superflous <code>&lt;span&gt;</code> tags in the post body which were used for element positioning in WordPress and no longer necessary in Ghost.</p>

<p>Next time I'll write about some of the other things I've done to customize my Ghost instance which I think are rather nice, but for now that's the end of this tutorial.</p>

<p>Happy blogging!</p>]]></description><link>https://iyware.com/migrate-from-wordpress-to-ghost/</link><guid isPermaLink="false">8884244a-654c-4a95-b0f0-24fcae4a8472</guid><category><![CDATA[Ghost]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Mon, 19 Jan 2015 07:49:03 GMT</pubDate></item><item><title><![CDATA[Moving]]></title><description><![CDATA[<p><strong>Update</strong>: We're mostly back up now.</p>

<p>Crazy things happening right now. You may notice this website looks very broken. Well, that’s just because I’m in the process of moving from a hosted version of WordPress to something a lot more nerdy:</p>

<p>A local <a href="http://ghost.org/">ghost</a> exported to static HTML via <a href="https://github.com/axitkhurana/buster">buster</a> (a lá <a href="http://jekyllrb.com/">jekyll</a>) and then pushed to <a href="https://pages.github.com/">github pages</a>.</p>

<p>Until then, this site’s gonna look a little broken, oh well :(</p>]]></description><link>https://iyware.com/moving/</link><guid isPermaLink="false">d80a404b-304a-41ac-afc0-fcf64e978200</guid><category><![CDATA[DevOps]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Fri, 09 Jan 2015 13:46:30 GMT</pubDate></item><item><title><![CDATA[Nexus5 Stock Lollipop Root How-To]]></title><description><![CDATA[<p>I just got my new <a href="http://www.google.com/nexus/5/">Nexus 5</a>, upgrading from my now almost 3 year old <a href="http://en.wikipedia.org/wiki/Galaxy_Nexus">Galaxy Nexus</a>. I got a good deal on the Galaxy Nexus because I bought it well after the <a href="http://en.wikipedia.org/wiki/Nexus_4">Nexus 4</a> was released and the price had dropped significantly. Unfortunately because of Google’s marketing strategy with the <a href="http://www.google.com/nexus/6/">Nexus 6</a> that didn’t happen this time; the prices for the Nexus 5 have remained pretty steady. But I needed (wanted) a new phone, so I bought it.</p>

<p>Unfortunately the Nexus 5 I received shipped with Android 4.4.x and I knew that 5.0 was available. I didn’t really want to do an upgrade immediately after setting up the phone, so I decided it would be best to flash the factory image since I have no data to lose. When I went to the <a href="http://forum.xda-developers.com/google-nexus-5">Nexus 5 section</a> of XDA-Developers I was a little disappointed. I just wanted a rooted, stock Lollipop ROM, but didn’t find one. In addition a lot of the toolkits etc… seemed a little dated. The last thing I wanted to do was download toolkits and then be manually updating components (roms, recoveries, root, etc…) so I decided to just do it myself. It was all pretty easy, so here’s the process I used, getting all the files directly from the sources, you can copy and paste these commands into your terminal and have your phone up and running pretty quickly- depending on your internet connection speed.</p>

<pre><code class="language-bash">brew install wget  
brew install android-platform-tools  
cd ~/Desktop  
mkdir nexus5  
cd nexus5  
wget http://download.chainfire.eu/636/SuperSU/UPDATE-SuperSU-v2.37.zip -O supersu.zip  
wget http://techerrata.com/file/twrp2/hammerhead/openrecovery-twrp-2.8.2.0-hammerhead.img -O recovery.img  
wget https://dl.google.com/dl/android/aosp/hammerhead-lrx21o-factory-01315e08.tgz -O lollipop.tgz  
PLUG IN YOUR DEVICE NOW #  
tar zxvf lollipop.tgz  
cd hammerhead-lrx21o  
adb reboot-bootloader  
fastboot oem unlock  
sh flash-all.sh  
# if it reboots, go back to bootloader #
adb reboot-bootloader  
cd ..  
fastboot flash recovery recovery.img  
fastboot reboot  
adb push supersu.zip /sdcard/0/  
adb reboot-bootloader  
# now boot recovery and install superSU zip, done!
</code></pre>

<p>The process is pretty simple: download root, TWRP, and the stock lollipop ROM. Flash the ROM, flash recovery, reboot the device, push the root zip, and reboot to fastboot. You’ll still need to manually flash SuperSU zip in TWRP, but that’s it. No messing with broken rapidshare links, no messing with outdated toolkits, just a nice rooted ROM.</p>]]></description><link>https://iyware.com/nexus5-stock-lollipop-root/</link><guid isPermaLink="false">43e6a11f-85a0-4114-8b8a-67c237bd26bb</guid><category><![CDATA[Android]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Fri, 12 Dec 2014 08:41:50 GMT</pubDate></item><item><title><![CDATA[Yosemite MAMP Homebrew Dev Setup, Part 2]]></title><description><![CDATA[<p>In my previous post <a href="https://iyware.com/osx-yosemite-mamp-homebrew-development-setup/" title="OS X 10.10 Yosemite, Apache, MySQL, PHP 5.6, (MAMP) Homebrew Dev Setup">OS X 10.10 Yosemite, Apache, MySQL, PHP 5.6, (MAMP) Homebrew Dev Setup</a> I covered a lot. Like a lot a lot, but by the end of the post all we had really accomplished was installing the basic building blocks of a development server, namely: Apache, MySQL, and PHP. In this post we’ll take those components and turn them into a sweet development workflow.</p>

<h2 id="updatingbrew">Updating Brew</h2>

<p>Everyone loves running <code>brew update &amp;&amp; brew upgrade</code> just to see what’s been updated. It’s a seriously <a href="https://github.com/Homebrew/homebrew/commits/master/Library/Formula">busy repo</a>, but it’s easy to forget to do and then your versions languish. Fortunately for us <a href="http://mkalmes.net/">Mark Kalmes</a> wrote a LaunchAgent plist for us called, aptly, <a href="http://mkalmes.net/2012/01/02/brewupdate-a-launchd-agent-for-automatic-homebrew-formulae-updates.html">brewupdate</a>. We’re going to grab the latest version and install it.</p>

<pre><code class="language-bash">curl https://raw.githubusercontent.com/mkalmes/brewupdate/develop/net.mkalmes.brewupdate.plist &gt; ~/Library/LaunchAgents/net.mkalmes.brewupdate.plist  
launchctl load ~/Library/LaunchAgents/net.mkalmes.brewupdate.plist  
</code></pre>

<p>The first line downloads the latest version straight from github to the user-space LaunchAgents folder. The second line loads it. You can edit the file and change when it updates, the default is 11 AM (local time zone). I changed mine to 8 AM because I like to start the day with a fresh brew (ha ha.)</p>

<p>Just don’t forget to run <code>brew upgrade</code> yourself occasionally. You could make another LaunchAgent by changing the parameter from <code>update</code> to <code>upgrade</code>, but I really don’t like unattended upgrades as much as updates.</p>

<h2 id="apache2documentroot">Apache 2: DocumentRoot</h2>

<p>That’s a clever title, you see we’re <em>running</em> Apache HTTPD 2, and at the same time this is part 2 of the Apache section… Anyways, at the end of Part 1 Apache was running on port 80 like a champ. The DocumentRoot is set to something ridiculous like <code>/usr/local/var/www/htdocs</code> which is pretty freaking inconvenient.</p>

<p>First we need to create our /Sites folder and we’ll still keep our web documents inside of that folder.</p>

<pre><code class="language-bash">mkdir ~/Sites ~/Sites/htdocs  
</code></pre>

<p>Then edit your <code>/usr/local/etc/apache2/2.4/httpd.conf</code> file and change the DocumentRoot directive, as well as accompanying Directory declaration to match your new htdocs location:</p>

<pre><code class="language-apacheconf">DocumentRoot "/Users/USERNAME/Sites/htdocs"  
&lt;directory&gt;  
&lt;/directory&gt;  
</code></pre>

<p>Obviously replace <code>USERNAME</code> with your username’s folder name. Then inside of that directory declaration we’re going to change some of the default Apache values to be more permissive:</p>

<pre><code class="language-apacheconf">Options All MultiViews  
AllowOverride All  
</code></pre>

<p>This is given with the usual caveat that OF COURSE you would never default everything like this on a production server- but on a development server there’s generally not much security implication (unless you’re playing with live data!). My full DocumentRoot section looks like this:</p>

<pre><code class="language-apacheconf">DocumentRoot "/Users/dannywahl/Sites/htdocs"  
&lt;directory&gt;  
  #
  # Possible values for the Options directive are "None", "All", 
  # or any combination of: 
  # Indexes Includes FollowSymLinks SymLinksifOwnerMatch ExecCGI MultiViews 
  # 
  # Note that "MultiViews" must be named *explicitly* --- "Options All" 
  # doesn't give it to you. # # The Options directive is both complicated and important. Please see 
  # http://httpd.apache.org/docs/2.4/mod/core.html#options 
  # for more information. 
  Options All MultiViews 
  # 
  # AllowOverride controls what directives may be placed in .htaccess files. 
  # It can be "All", "None", or any combination of the keywords: 
  # AllowOverride FileInfo AuthConfig Limit 
  AllowOverride All 
  # 
  # Controls who can get stuff from this server. 
  # Require all granted
&lt;/directory&gt;  
</code></pre>

<p>Now, restart your httpd daemon:</p>

<pre><code class="language-bash">sudo httpd -k restart  
</code></pre>

<p>If you didn’t use <code>--with-privileged-ports</code> when you installed Apache then you don’t need root. Now when you visit <a href="http://localhost/">http://localhost</a> you should just get a blank directory listing instead of the default “It Works!” page. Let’s put a test page there. First let’s create a sub-directory in our /Sites folder called <code>phpinfo.localhost</code> (more on the <code>.</code> later).</p>

<pre><code class="language-bash">mkdir ~/Sites/phpinfo.localhost  
</code></pre>

<p>Now let’s create a page that calls the <code>phpinfo();</code> function and place it in that folder. if you don’t know about <a href="http://cn2.php.net/manual/en/function.phpinfo.php">phpinfo()</a> it’s a simple function that outputs a page that shows you information about your PHP configuration.</p>

<pre><code class="language-bash">printf ‘&lt;?php phpinfo(); ??&gt;‘ &gt;&gt; ~/Sites/htdocs/phpinfo.localhost/index.php  
</code></pre>

<p>Now you should be able to visit <code>http://localhost/phpinfo.localhost/</code> and see the overview of your PHP configuration. That’s it for now for Apache, let’s move on to MySQL.</p>

<h2 id="mysql">MySQL</h2>

<p>In the first post we simply installed MySQL and set a root password. It’s good to have a password because some authentication APIs require one, but we’re not necessarily using it for security (otherwise we wouldn’t be using root), so we’re going to save our authentication in a my.cnf <a href="http://dev.mysql.com/doc/refman/5.1/en/option-files.html">options file</a>. Homebrew provides us with a sample file, but it’s not symlinked by default so we’re going to copy it to an available configuration folder and since MySQL is running in user-space, we will override the configuration at the user-space level:</p>

<pre><code class="language-sql">cp -v $(brew –prefix mysql)/support-files/my-default.cnf ~/.my.cnf  
</code></pre>

<p>Now we have our config override, let’s have it auto-save our credentials.</p>

<pre><code class="language-bash">cat &gt; ~/.my.cnf  
[client] 
user=root  
password=PASS  
[mysql] 
user=root  
password=PASS  
[mysqldump] 
user=root  
password=PASS  
[mysqldiff] 
user=root  
password=PASS  
EOF  
</code></pre>

<p>Replace “PASS” with your root MySQL password. If you have special characters in your password, which you shouldn’t, add double quotes around the password. Now you can connect to mysql without having to manually authenticate.</p>

<pre><code class="language-sql">mysql -u root  
</code></pre>

<h2 id="phpmyadmin">phpmyadmin</h2>

<p>Finally we’re going to install everyone’s favorite database manager, <a href="http://www.phpmyadmin.net/home_page/index.php">phpmyadmin</a>. Again, we’ll be using homebrew to install it.</p>

<pre><code class="language-bash">brew install phpmyadmin  
</code></pre>

<p>After a successful installation you will get a caveat about adding a directory alias to your httpd configuration to enable phpmyadmin, but we’re not going to do that we’re going to <a href="http://en.wikipedia.org/wiki/Symbolic_link">symlink</a> it to to our ~/Sites directory.</p>

<pre><code class="language-bash">ln -s /usr/local/share/phpmyadmin ~/Sites/htdocs/phpmyadmin.localhost  
</code></pre>

<p>This will create a symbolic link in your webroot called phpmyadmin.localhost that takes you to /usr/local/share/phpmyadmin (which itself is a symlink to the Cellar). The benefit here is you don’t need to restart Apache, and again we’ll go over it later but the .localhost is important.</p>

<p>Now that phpmyadmin is installed, we need to configure it. First we’ll import the phpmyadmin linked tabled <a href="http://docs.phpmyadmin.net/en/latest/setup.html#linked-tables">configuration storage</a> via commandline:</p>

<pre><code class="language-sql">mysql -u root -e 'CREATE DATABASE IF NOT EXISTS `phpmyadmin`;'  
mysql -u root phpmyadmin  
</code></pre>

<p>Once the tables are imported open your phpmyadmin config file located at <code>/usr/local/etc/phpmyadmin.config.inc.php</code> and you're going to do a few things:</p>

<ol>
<li><a href="http://www.question-defense.com/tools/phpmyadmin-blowfish-secret-generator">generate a blowfish secret</a>  </li>
<li>Set your <code>controluser</code> and <code>controlpass</code> (I use root again)  </li>
<li>Uncomment the storage database and tables section</li>
</ol>

<p>In the end your blowfish and servers configuration sections should look something like this:</p>

<pre><code class="language-php">$cfg['blowfish_secret'] = 'y=PUY@-GleE+~%OiGQVz#)N4I)@Q%Ug_Jr[DxF';
/* YOU MUST FILL IN THIS FOR COOKIE AUTH! */
/* * Servers configuration */
$i = 0;
/* * First server */
$i++;
/* Authentication type */
$cfg['Servers'][$i]['auth_type'] = 'cookie';
/* Server parameters */
$cfg['Servers'][$i]['host'] = '127.0.0.1';
$cfg['Servers'][$i]['connect_type'] = 'tcp';
$cfg['Servers'][$i]['compress'] = false;
$cfg['Servers'][$i]['AllowNoPassword'] = false;
/* * phpMyAdmin configuration storage settings. */
/* User used to manipulate with storage */
// $cfg['Servers'][$i]['controlhost'] = '';
// $cfg['Servers'][$i]['controlport'] = '';
$cfg['Servers'][$i]['controluser'] = 'root';
$cfg['Servers'][$i]['controlpass'] = 'root';
/* Storage database and tables */
$cfg['Servers'][$i]['pmadb'] = 'phpmyadmin';
$cfg['Servers'][$i]['bookmarktable'] = 'pma__bookmark';
$cfg['Servers'][$i]['relation'] = 'pma__relation';
$cfg['Servers'][$i]['table_info'] = 'pma__table_info';
$cfg['Servers'][$i]['table_coords'] = 'pma__table_coords';
$cfg['Servers'][$i]['pdf_pages'] = 'pma__pdf_pages';
$cfg['Servers'][$i]['column_info'] = 'pma__column_info';
$cfg['Servers'][$i]['history'] = 'pma__history';
$cfg['Servers'][$i]['table_uiprefs'] = 'pma__table_uiprefs';
$cfg['Servers'][$i]['tracking'] = 'pma__tracking';
$cfg['Servers'][$i]['designer_coords'] = 'pma__designer_coords'; 
$cfg['Servers'][$i]['userconfig'] = 'pma__userconfig';
$cfg['Servers'][$i]['recent'] = 'pma__recent';
$cfg['Servers'][$i]['favorite'] = 'pma__favorite';
$cfg['Servers'][$i]['users'] = 'pma__users';
$cfg['Servers'][$i]['usergroups'] = 'pma__usergroups';
$cfg['Servers'][$i]['navigationhiding'] = 'pma__navigationhiding';
$cfg['Servers'][$i]['savedsearches'] = 'pma__savedsearches';
/* Contrib / Swekey authentication */
// $cfg['Servers'][$i]['auth_swekey_config'] = '/etc/swekey-pma.conf';
/* * End of servers configuration */
</code></pre>

<p>You might notice that I changed my host to "127.0.0.1" from "localhost". By default /etc/hosts should resolve localhost to 127.0.0.1 so it shouldn't trigger a DNS lookup, but by changing it to an IP address you'll never have that happen because there are ways to inadvertently send lookups to your machine DNS for localhost. Again, this is not necessary. After saving your phpmyadmin configuration you should be able to visit the page at <code>http://localhost/phpmyadmin.localhost</code></p>

<h2 id="dnsmasq">dnsmasq</h2>

<p><a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">Dnsmasq</a> is a lightweight DNS/DHCP server which can be installed and serve DNS for addresses that aren't in the <a href="http://en.wikipedia.org/wiki/Global_Namespace">global namespace</a>. We'll be installing dnsmasq via homebrew and configuring it, along with Apache to serve sites on <a href="http://en.wikipedia.org/wiki/Top-level_domain#Reserved_domains">reserved TLDs</a>.</p>

<pre><code class="language-bash">brew install dnsmasq  
</code></pre>

<p>Once dnsmasq is installed we need to copy a configuration profile, edit it, and then load the daemon. First we'll copy a provided configuration:</p>

<pre><code class="language-bash">cp /usr/local/opt/dnsmasq/dnsmasq.conf.example /usr/local/etc/dnsmasq.conf  
printf '\naddress=/localhost/127.0.0.1' &gt;&gt; /usr/local/etc/dnsmasq.conf  
sudo cp -fv /usr/local/opt/dnsmasq/*.plist /Library/LaunchDaemons  
sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.dnsmasq.plist  
</code></pre>

<p>Effectively we are telling dnsmasq to resolve all .localhost domains to 127.0.0.1 and setting it to run the daemon at the machine level (with Apache). So you can now try to ping any .localhost domain and it will resolve to 127.0.0.1:</p>

<pre><code class="language-bash">ping -c 1 thisdoesntexist.localhost  
PING thisdoesntexist.localhost (127.0.0.1): 56 data bytes  
64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.029 ms

--- thisdoesntexist.localhost ping statistics ---
1 packets transmitted, 1 packets received, 0.0% packet loss  
round-trip min/avg/max/stddev = 0.029/0.029/0.029/0.000 ms  
</code></pre>

<p>Obviously trying to visit <a href="http://thisdoesntexit.localhost/">http://thisdoesntexit.localhost</a> won't work because Apache isn't configured to handle requests to that address, yet. There are two different ways to configure this, the first is to create a vhost entry for every domain you want to use, the second is to enable <a href="http://httpd.apache.org/docs/2.2/mod/mod_vhost_alias.html">mod_vhost_alias</a>- which is what we'll do now.</p>

<h2 id="mod_vhost_alias">mod_vhost_alias</h2>

<p>Mod_vhost_alias is an Apache module that let's you do pattern matching from a request URL to a directory structure, there are lots of cool examples at the documentation site- but the one we want is pretty straight forward. Open your httpd.conf file (in /usr/local/etc/apache2/2.4/) and uncomment the mod_vhost_alias module</p>

<pre><code class="language-apacheconf">LoadModule vhost_alias_module libexec/mod_vhost_alias.so  
</code></pre>

<p>then in terminal we'll configure vhost_alias_module:</p>

<pre><code class="language-bash">printf '\nUseCanonicalName Off\nVirtualDocumentRoot /Users/USERNAME/Sites/htdocs/%%0' &gt;&gt; /usr/local/etc/apache2/2.4/httpd.conf  
</code></pre>

<p>And finally restart the httpd daemon:</p>

<pre><code class="language-bash">sudo httpd -k restart  
</code></pre>

<p>The end result is that now every folder that ends in .localhost in your ~/Sites/htdocs/ folder is accessible as a <a href="http://en.wikipedia.org/wiki/Fully_qualified_domain_name">FQDN</a>. Go back to your browser and now you can visit <a href="http://phpinfo.localhost/">http://phpinfo.localhost</a> and <a href="http://phpmyadmin.localhost/">http://phpmyadmin.localhost</a> If you create another folder inside of htdocs that ends in .localhost it will be available in your dev environment as a standalone domain. Here's a couple of examples of how that could be useful:</p>

<p>Say you want a standalone domain of wordpress:</p>

<pre><code class="language-bash">git clone git@github.com:WordPress/WordPress.git ~/Sites/htdocs/wordpress.localhost  
</code></pre>

<p>What about multiple branches of drupal on standalone domains? Let's make <code>http://drupal6.localhost</code> and <code>http://drupal7.localhost</code></p>

<pre><code class="language-bash">git clone git@github.com:drupal/drupal.git --branch 6.x --single-branch ~/Sites/htdocs/drupal6.localhost  
git clone git@github.com:drupal/drupal.git --branch 7.x --single-branch ~/Sites/htdocs/drupal7.localhost  
</code></pre>

<p>As another example, how about a single domain with multiple moodle instances in sub-directories like <code>http://moodle.localhost/26</code> and <code>http://moodle.localhost/27</code></p>

<pre><code class="language-bash">mkdir ~/Sites/htdocs/moodle  
git clone git@github.com:moodle/moodle.git --branch MOODLE_26_STABLE --single-branch ~/Sites/htdocs/moodle/26  
git clone git@github.com:moodle/moodle.git --branch MOODLE_27_STABLE --single-branch ~/Sites/htdocs/moodle/27  
</code></pre>

<h2 id="wrappingup">Wrapping Up</h2>

<p>So there you go! Mac OS X with brewed versions of important stuff like openssl and git, Apache 2.4, MySQL, and PHP 5.6 and a killer setup using mod<em>vhost</em>alias and dnsmasq to provision .localhost domains on the fly. Of course there are a million ways to dev from here, but this is a pretty solid foundation.</p>

<p>If you need help with educational technology in your institution, from strategic planning, to implementation, to technical support contact us and we can help get you on the path to success.</p>]]></description><link>https://iyware.com/yosemite-mamp-homebrew-dev-setup-part-2/</link><guid isPermaLink="false">9a641183-9430-493a-9294-b85129cefb68</guid><category><![CDATA[DevOps]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Tue, 28 Oct 2014 19:39:48 GMT</pubDate></item><item><title><![CDATA[OS X 10.10 Yosemite, Apache, MySQL, PHP 5.6, (MAMP) Homebrew Dev Setup]]></title><description><![CDATA[<h2 id="update">Update:</h2>

<p>A quick update, this was originally written for Yosemite Beta 1, XCode 6 Beta, and PHP56 RC1. Now that the official versions of all those are out, a lot of this post is unnecessary because, well, stable software is much more… stable. Who knew? Anyways, here’s a tl;dr for the stable version:</p>

<pre><code class="language-bash"># Install Homebrew
xcode-select --install  
ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"  
brew doctor  
# Tap Repos
brew tap homebrew/dupes  
brew tap homebrew/versions  
brew tap homebrew/homebrew-php  
brew tap homebrew/apache  
# Verify 
brew update &amp;&amp; brew upgrade  
# Macintosh 
brew install git  
brew install openssl  
ssh-keygen -t rsa -C "email@address.invalid"  
ssh-add ~/.ssh/id_rsa  
# Apache 
sudo apachectl stop  
sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist 2&gt;/dev/null  
brew install httpd24 --with-privileged-ports --with-brewed-ssl  
sudo cp -v /usr/local/Cellar/httpd24/2.4.10/homebrew.mxcl.httpd24.plist /Library/LaunchDaemons  
sudo chown -v root:wheel /Library/LaunchDaemons/homebrew.mxcl.httpd24.plist  
sudo chmod -v 644 /Library/LaunchDaemons/homebrew.mxcl.httpd24.plist  
sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.httpd24.plist  
sudo httpd -k start  
# MySQL 
brew install mysql  
ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents  
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist  
mysqladmin -u root password "NEWPASSWORD"  
# PHP
brew install php56 --homebrew-apxs --with-apache --with-homebrew-curl --with-homebrew-openssl --with-phpdbg --with-tidy --without-snmp  
chmod -R ug+w /usr/local/Cellar/php56/5.6.2/lib/php  
pear config-set php_ini /usr/local/etc/php/5.6/php.ini  
printf '\nAddHandler php5-script .php\nAddType text/html .php' &gt;&gt; /usr/local/etc/apache2/2.4/httpd.conf  
perl -p -i -e 's/DirectoryIndex //DirectoryIndex index.php //g' /usr/local/etc/apache2/2.4/httpd.conf  
printf '\nexport PATH="$(brew --prefix homebrew/php/php56)/bin:$PATH"' &gt;&gt; ~/.profile  
# Dev Stuff 
brew install composer  
brew install behat  
brew install node  
npm -g install grunt  
npm -g install shifter  
brew tap danpoltawski/homebrew-mdk  
brew install moodle-sdk  
</code></pre>

<h2 id="originalpost">Original Post:</h2>

<p>It’s that time of the year again. Apple will soon release a <a href="http://www.apple.com/osx/preview/">"new" OS</a> (10.10 Yosemite) and in celebration I’ll format my hard drive and reinstall from scratch and then slowly start reconfiguring my machine for development purposes. So I figured, if I’m going to do it- I might as well document it too. Because, to be honest, I kinda forget what I’ve done… Over a few posts we will look at every step of setting up a Moodle development machine from services configuration through installing Moodle and we’ll document all the tools and commands that are needed along the way. In part one we’ll go over installing Homebrew, git, Apache, MySQL, and PHP. In part two we’ll go over configuring Apache, MySQL, and git, as well as how to use the MDK, git, and JIRA to contribute your code. This post is good for any developer that’s using PHP- not just Moodle. So if you want to set up a Mac to develop in WordPress, Drupal, or whatever- this will get you started.</p>

<h2 id="startingpoint">Starting Point</h2>

<p>Sorry, we won’t be starting with the unboxing of a new Mac, because I didn’t have a $2,000 budget for this post. And in fact we won’t even be starting with the OS setup, which is OK because if you’re using 10.7 or newer, then you’re okay. If you’re still running 10.6 I’m going to assume that it’s because Apple locked you out of updates because your machine is too old, jerks. Do yourself a favor, buy a new PC.</p>

<p>Here’s what you’ll need: Internet access (how are you even reading this?), administrative privileges (the account doesn’t have to be admin), and accounts at a couple of websites (or the ability to sign up). I’ll also need your credit card number and the last four digits of your social security number, just leave them in the comments. Just kidding, don’t.</p>

<h2 id="mappmampmeh">MAPP? MAMP? Meh.</h2>

<p>If you spend any amount of time in the <a href="https://moodle.org/course/view.php?id=5">Moodle forums</a> you’ll run across all kinds of cool acronyms. Usually the <a href="https://docs.moodle.org/27/en/Glossary_auto-linking_filter">glossary auto-linker</a> will fill your head with some cool new knowledge, but for the sake of thoroughness we’ll go over a few of them here. You may see people talk about their WAMP or MAMP or LAMP server. Generally this describes their server configuration.</p>

<p>If somebody says they’re using <span style="text-decoration: underline;">W</span>AMP that means that their server is running on "Windows". Lamp would be "Linux" and MAMP – Mac. Though technically it should be "OS X" but OAMP is hard to say. Generally most web softwares don’t need a specific platform to run on, a website can run on any operating system. Generally. Stupid ASP.</p>

<p>The second letter, "A", which in the examples above is consistent means that the web service running on the server is "Apache". There are a variety of web service applications available including IIS, Nginx, lighttpd. <em>Generally</em> the software (i.e. Moodle) doesn’t mandate a specific web server software either. Now it could be that the software (i.e. Moodle) depends on some other software (i.e. PHP) that is not compatible or available on that web server. But again, this isn’t usually a problem.</p>

<p>The Third letter defines the database type. Moodle supports 4 different databases out of the box: MySQL, PostgreSQL, Oracle, and MSSQL. Because Moodle has a sweet database driver ($DB) the database that you use doesn’t really matter- in terms of developing on your machine. If you’re trying to pick a database for a large, live server, it probably does matter. So if you see LAMP, MySQL or LAPP, PostgreSQL. Users of other DB types aren’t so clever so they’ll just say boring stuff like "I’m using Windows Server 2008 RC2 with IIS 7 and MSSQL." instead of WS08RC2IIS7MSSQLFTW, which in my opinion is cooler AND easier to understand.</p>

<p>Finally, the last "P" stands for "PHP" which stands for "PHP Hypertext Preprocessor" which stands for "PHP Hypertext Preprocessor Hypertext Preprocessor" which stands for "All work and no play makes Jack a dull boy." Anyways… You’ll need this. Moodle won’t run with out it, and without a specific version as mentioned in the release notes of the Moodle version you download.</p>

<p>With so many options, how do you choose? Like I said in the title, "Meh". I’m going to assume you’re developing on a Mac, so that rules out Windows and Linux. Apache is by far the most popular web server and is included with OS X. MSSQL and Oracle don’t run on OS X. You need PHP.</p>

<p>So your only real options are MySQL or PostgreSQL, and we’ll cover that in a bit, but first let’s start with "M".</p>

<h2 id="macintoshosx">Macintosh (OS X)</h2>

<p>We need to do a bit of configuring of our Mac before we dive into setting up services. Mostly this will involve downloading some applications.</p>

<h3 id="getgit">Get git</h3>

<p>Moodle development is managed using <a href="http://en.wikipedia.org/wiki/Git_%28software%29">git</a>. git in a nutshell lets you track changes of code from lots of users. If you’re going to be doing Moodle development you MUST use git. Fortunately OS X comes with git included, but you can’t use it. Open up terminal and enter the following command:</p>

<pre><code class="language-bash">which git; git -version  
</code></pre>

<p>and you’ll end up with a return something like this</p>

<pre><code class="language-bash">which git  
/usr/bin/git
git -version  
xcode-select: note: no developer tools were found at '/Applications/Xcode.app', requesting install. Choose an option in the dialog to download the command line developer tools.  
</code></pre>

<p>with a prompt to download XCode command line tools:</p>

<p><img src="https://iyware.com/content/images/import/Screen-Shot-2014-07-27-at-2.38.29-pm-960x600.png" alt="what git?"></p>

<p>Go ahead and download it. It’s also worth it to install Xcode as well. For this post you will need both Xcode 5 which you can download from the <a href="https://developer.apple.com/downloads/index.action">Apple Developer site</a> and the <a href="https://developer.apple.com/xcode/downloads/">Xcode 6 beta</a>. I recommend that you rename Xcode 5 from "xcode.app" to "xcode5.app" and Xcode 6 from "Xcode-beta.app" to "Xcode.app" because most of our toolchain will be using the utilities in Xcode 6. Once Xcode and the command line tools are installed we can now use the version of git included with OS X- however it’s a little dated, and we’re going to install a newer version of git from somewhere else.</p>

<p>When it comes to installing the git binary we have a few different choices. First, we can install the <a href="http://git-scm.com/downloads">official git version</a> from git-scm.com, second we can install a bundled version of git with a different application like <a href="https://mac.github.com/">github for Mac</a> or <a href="http://www.git-tower.com/">git-tower</a> (both of which we’ll go over later), or third you can use a third-party package manager to install a copy of git for you. This last option is the one we will be using.</p>

<h3 id="homebrew">Homebrew</h3>

<p><a href="http://brew.sh/">Homebrew</a> is self-styled "The missing package manager for OS X" and they really deliver. If you’ve spent any amount of time working on an <em>actual</em> Unix or Linux machine you probably both appreciate OS X’s "Unix roots" and really dislike what Apple has chosen to trim back. Without a package manager like pac-man, apt, or the like, OS X is really limited. Homebrew solves that in a really elegant way, so let’s install it. Open up terminal and copy and paste this single command:</p>

<pre><code class="language-bash">ruby -e "$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)"  
</code></pre>

<p>This command has three requirements, one you need to have administrator access or you’ll not be able to install the program as the <code>/usr/</code> directory is protected. Two you’ll need internet access as the command downloads the script from github and then passes it to ruby to run. If you don’t have internet access you’ll see an error like this:</p>

<pre><code class="language-bash">ruby -e "$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)"  
curl: (6) Could not resolve host: raw.github.com  
</code></pre>

<p>Three, you will need to have the XCode command line utilities installed. You should have already install them. If you don’t have the command line tools installed then you will be prompted to install them:</p>

<pre><code class="language-bash">==&gt; Installing the Command Line Tools (expect a GUI popup): 
==&gt; /usr/bin/sudo /usr/bin/xcode-select --install 
xcode-select: note: install requested for command line developer tools Press any key when the installation has completed.  
</code></pre>

<p>After that you should be good to go. Just run <code>brew doctor</code> as recommended to make sure everything’s okay.</p>

<pre><code class="language-bash">ruby -e "$(curl -fsSL https://raw.github.com/Homebrew/homebrew/go/install)"  
==&gt; This script will install: 
/usr/local/bin/brew /usr/local/Library/... 
/usr/local/share/man/man1/brew.1 
Press RETURN to continue or any other key to abort  
==&gt; /usr/bin/sudo /bin/mkdir /usr/local 
WARNING: Improper use of the sudo command could lead to data loss or the deletion of important system files. Please double-check your typing when using sudo. Type "man sudo" for more information. To proceed, enter your password, or type Ctrl-C to abort.  
Password:  
==&gt; /usr/bin/sudo /bin/chmod g+rwx /usr/local 
==&gt; /usr/bin/sudo /usr/bin/chgrp admin /usr/local 
==&gt; /usr/bin/sudo /bin/mkdir /Library/Caches/Homebrew 
==&gt; /usr/bin/sudo /bin/chmod g+rwx /Library/Caches/Homebrew 
==&gt; Downloading and installing Homebrew... 
remote: Counting objects: 188543, done.  
remote: Compressing objects: 100% (51551/51551), done.  
remote: Total 188543 (delta 135844), reused 188510 (delta 135819)  
Receiving objects: 100% (188543/188543), 37.53 MiB | 395.00 KiB/s, done.  
Resolving deltas: 100% (135844/135844), done.  
From https://github.com/Homebrew/homebrew * [new branch] master -&gt; origin/master HEAD is now at 881c231 Fix up dep directories before activating ENV extensions  
==&gt; Installation successful! 
==&gt; Next steps Run `brew doctor` before you install anything Run `brew help` to get started 
brew doctor  
Your system is ready to brew.  
</code></pre>

<p>If you see "Your system is ready to brew." then we can move on to the next step. At this point you do have OS X’s version of git installed. To see your specific version run <code>git --version</code> in terminal:</p>

<pre><code class="language-bash">git --version git version 1.9.3 (Apple Git-50)  
</code></pre>

<p>That’s the version on my system, which is the bleeding-edge version of git that Apple is shipping on a beta operating system and according to <a href="https://github.com/git/git/releases">github releases</a>, it was released (at time of this writing) about two and a half months ago. Not to mention it’s a full major release behind. git-scm.com has the latest version of git available as 2.0.3. I like to be a little more up to date than that. If we search the homebrew repository we can see the latest version available is 2.0.2:</p>

<pre><code class="language-bash">brew search git  
bagit           git-extras      git-number      giter8  
bash-git-prompt git-flow        git-open        gitfs  
easy-git        git-flow-avh    git-review      github-release  
geogit          git-flow-clone  git-sh          gitslave  
git             git-ftp         git-ssh         legit  
git-annex       git-gerrit      git-tf          libgit2  
git-archive-all git-imerge      git-tf-2.0.2    libgit2-glib  
git-cal         git-integration git-tig         magit  
git-cola        git-latexdiff   git-tracker     stgit  
git-crypt       git-multipush   git-url-sub     topgit  
git-encrypt     git-now         gitbucket  
</code></pre>

<p>At the time of this writing 2.0.2 is only 13 days old and 2.0.3 is only 5 days old. That’s a much better timeframe for updating. So let’s install the homebrew version of git using <code>brew install git</code></p>

<pre><code class="language-bash">brew install git  
==&gt; Downloading https://www.kernel.org/pub/software/scm/git/git-2.0.3.tar.gz
######################################################################## 100.0% 
==&gt; make prefix=/usr/local/Cellar/git/2.0.3 sysconfdir=/usr/local/etc CC=clang C 
==&gt; make CC=clang CFLAGS= LDFLAGS= ==&gt; make clean ==&gt; make CC=clang CFLAGS= LDFLAGS= 
==&gt; Downloading https://www.kernel.org/pub/software/scm/git/git-manpages-2.0.3.t
######################################################################## 100.0% 
==&gt; Downloading https://www.kernel.org/pub/software/scm/git/git-htmldocs-2.0.3.t 
######################################################################## 100.0% 
==&gt; Caveats The OS X keychain credential helper has been installed to: 
/usr/local/bin/git-credential-osxkeychain 
The 'contrib' directory has been installed to:  
/usr/local/share/git-core/contrib 
Bash completion has been installed to:  
/usr/local/etc/bash_completion.d 
zsh completion has been installed to:  
/usr/local/share/zsh/site-functions 
==&gt; Summary /usr/local/Cellar/git/2.0.3: 1328 files, 31M, built in 69 seconds
</code></pre>

<p>So you’ll see a couple of things- first we actually installed 2.0.3 and that’s because homebrew isn’t a repository of binaries, it simply manages them, the install actually comes from the main git repository at git-scm (kernel.org). In addition to the vanilla git binary we also get bash completion and man pages. Sweet! Go ahead and check the version again, you may have to quit your terminal session and start a new one.</p>

<pre><code class="language-bash">dannywahlmbp:~ dannywahl$ git --version git version 2.0.3  
</code></pre>

<p>That’s pretty much it for git, now we can move on to github, where we’ll be managing our source code.</p>

<h3 id="github">Github</h3>

<p><a href="https://github.com/">Github</a> is where all the cool kids are storing their code these days. Well, everybody except <a href="http://git.moodle.org/gw">Moodle</a> and <a href="https://gitorious.org/mahara">Mahara</a>. But at least they provide copies of their work at github- Moodle at least, I didn’t check Mahara (too lazy to open a new tab…).</p>

<p>Basically Github is "the cloud" for source code versioning. You create a repository there, "clone" it to your machine, edit, and push your changes back to the server. If you’re new to git there are lots of resources available to you. We’ll cover a few basics in this post but mastering it is beyond the scope. I suggest you check out:</p>

<ul>
<li><a href="http://www.git-tower.com/learn/ebook/mac/introduction">Learn Version Control With Git</a></li>
<li><a href="http://git-scm.com/book/en/Getting-Started">Git –local-branching-on-the-cheap</a></li>
<li><a href="https://try.github.io/levels/1/challenges/1">Code School – Try Git</a></li>
<li><a href="https://www.atlassian.com/git/tutorial/git-basics">Git Tutorials</a></li>
</ul>

<p>Sorry, that list isn’t nearly as fun as anything Buzzfeed has put together, and full disclosure- I learned git just by Moodle development so I can’t vouch for any of the above resources… (then why did I even recommend them? Stupid!) Anyways…</p>

<p>If you do not already have an account at github you will need to go <a href="https://github.com/join">sign up</a>. Once you’ve cleared the hoops of verifying email, etc… log in. Github should provide you with a nice step-by-step tutorial of setting up you Mac. But we’ll do it again, just to be sure!</p>

<p>Log in and head over to your <a href="https://github.com/settings/profile">profile</a>, fill in any info you want and then click on the <a href="https://github.com/settings/ssh">SSH Keys</a> tab on the left. <a href="http://en.wikipedia.org/wiki/Ssh">SSH</a> basically lets you securely communicate with the server where you are storing your code. Right now we’ll go through the process of generating an SSH key and storing it on github.</p>

<h4 id="checkforexistingsshkeys">Check for existing SSH Keys</h4>

<p>Open Terminal again, now if you’re on a fresh OS install you won’t have to do this but you can. Type the following command:</p>

<pre><code class="language-bash">ls -lsa ~/.ssh  
</code></pre>

<p><code>ls</code> is the command to ‘list’ everything in a directory. <code>~</code> is short code for your home folder, on a Mac that’s /Users/UserName (by default). <code>/</code> is a folder inside of your home folder. <code>.ssh</code> is the name of the folder. On Unix systems a folder that starts with a ‘.’ will be hidden- no need for <a href="http://ss64.com/osx/chflags.html">chflags</a>! So we’ve put together a command that says "show the contents of the hidden folder ‘.ssh’ inside of my home folder". And that is probably shockingly similar to the AppleScript that you would use to do that too.</p>

<p>If terminal gives you this return:</p>

<pre><code class="language-bash">ls -lsa ~/.ssh ls: /Users/dannywahl/.ssh: No such file or directory  
</code></pre>

<p>then we need to create the directory with another command (just copy and paste):</p>

<pre><code class="language-bash">mkdir ~/.ssh; chmod 700 ~/.ssh  
</code></pre>

<p>This will do two things, create the ssh directory, and then make sure only you can access it. You can learn more about Unix permissions <a href="http://en.wikipedia.org/wiki/Unix_permissions#Numeric_notation">here</a>.</p>

<p>If terminal gives you this return:</p>

<pre><code class="language-bash">ls -lsa ~/.ssh/  
total 16  
0 drwx------ 4 dannywahl staff 136 Jul 31 16:41 .  
0 drwxr-xr-x+ 18 dannywahl staff 612 Jul 31 16:36 ..  
8 -rw------- 1 dannywahl staff 1766 Jul 31 16:41 id_rsa  
8 -rw-r--r-- 1 dannywahl staff 398 Jul 31 16:41 id_rsa.pub  
</code></pre>

<p>Then you already have an SSH Key. IF you created this key and are sure of its security you can use it with github, skip to the "Adding your SSH Key to Github" section below. Otherwise you can create a new one.</p>

<h4 id="creatingansshkeypair">Creating an SSH Key Pair</h4>

<p>When you create an SSH key you actually create two keys, a private key and a public key. You keep the private key and you can share the public key with others. This allows them to receive messages and ensure it is from you, but they can’t pretend to be you and send out messages on your behalf. Back in terminal we’re going to create a new <a href="http://en.wikipedia.org/wiki/RSA_%28cryptosystem%29">RSA</a> SSH key set. Run the command:</p>

<pre><code class="language-bash">ssh-keygen -t rsa -C "email@address.invalid"  
</code></pre>

<p>This will kick off a "Wizard" of sorts and walk you through creating your key pair. First you need to specify where to save the new keys, the default is your ~/.ssh folder, so just push enter.</p>

<pre><code class="language-bash">Generating public/private rsa key pair.  
Enter file in which to save the key (/Users/dannywahl/.ssh/id_rsa):  
</code></pre>

<p>Note that you can specify a different name, as you can have multiple SSH key pairs. Though for most instances a single pair is all that is necessary.</p>

<p>Next it will ask you for a key passphrase, which is optional. I strongly suggest that you add a passphrase for both added security and the fact that other SSH applications (not github) require a passphrase to function properly and if you want to reuse your key pair you will need a passphrase. Type your passphrase press Enter and type it again to make sure it matches.</p>

<pre><code class="language-bash">Enter passphrase (empty for no passphrase):  
Enter same passphrase again:  
</code></pre>

<p>After that your key pair will be save and you will be given some information about it. It will look something like this:</p>

<pre><code class="language-bash">Your identification has been saved in /Users/dannywahl/.ssh/id_rsa.  
Your public key has been saved in /Users/dannywahl/.ssh/id_rsa.pub.  
The key fingerprint is:  
fa:e7:5c:f2:60:d8:ad:44:3c:a4:07:0d:b5:09:77:9f  
danny@iyware.com  
The key's randomart image is:  
+--[ RSA 2048]----+ 
| =A+ . | | *=* . |
| +.=oE . | | . o= 
= | | .S . | | . | 
| | | | | | 
+-----------------+
</code></pre>

<p>The finger print and randomart allow you to verify that a public key copy is a real copy. Please note that these are NOT my real public key credentials. On that note you should NEVER share your private key with anyone.</p>

<h4 id="activatingyourkey">Activating Your Key</h4>

<p>Now that you have created your key you need to tell the operating system to use it. We will use the <code>ssh-add</code> command to load your key. Enter this command, and then type your key passphrase. If you didn’t enter a passphrase, simply press Enter.</p>

<pre><code class="language-bash">ssh-add ~/.ssh/id_rsa  
Enter passphrase for /Users/dannywahl/.ssh/id_rsa:  
Identity added: /Users/dannywahl/.ssh/id_rsa (/Users/dannywahl/.ssh/id_rsa)  
</code></pre>

<h4 id="copyyourpublickeytogithub">Copy Your Public Key to Github</h4>

<p>The final step is to give github a copy of your public key. If you don’t have the <a href="https://github.com/settings/ssh">SSH Keys</a> page open you will need to navigate there and click "Add SSH Keys". You can store more than one key with github, which is useful if you have multiple devices that you do development from.</p>

<p>Back in terminal you have one more command to run, simply copy and paste (unless you renamed your key):</p>

<pre><code class="language-bash">pbcopy &lt; ~/.ssh/id_rsa.pub  
</code></pre>

<p>This command copies the contents of your public key to your clipboard. You can also open your key in a text editor and copy the contents but this command prevents both omitting a character and accidentally editing the key. Switch back to github and paste in the "Key" field. If there’s a blank line at the end, that’s ok- don’t erase it. Remember we want the contents of the key exactly.</p>

<p>You’ll want to give you key a title so that if you ever have a security issue at github you can see exactly which machine accessed or changed which repositories. Your page should look something like this:</p>

<p><img src="https://iyware.com/content/images/import/addkey-960x600.png" alt="Add an SSH Public Key"></p>

<p>Click the "Add key" button and you’ll be taken back to the SSH Keys page, where your new key will be listed. If you look at terminal you’ll notice that the fingerprints match.</p>

<p><img src="https://iyware.com/content/images/import/sshkeys-960x600.png" alt="sshkeys"></p>

<p>For now we’re done with github. So far we’ve set up homebrew, installed git, created an SSH key pair, and added a copy of our public key to github. Next we’ll start setting up the "server" side of our development machine, starting with Apache.</p>

<h2 id="apache">Apache</h2>

<p>The <a href="http://httpd.apache.org/">Apache HTTPD</a> server is the most popular web server in the world. And in fact Apache is included with OS X by default. Just copy and paste this command into terminal:</p>

<pre><code class="language-bash">apachectl -v  
</code></pre>

<p>Mine says:</p>

<pre><code class="language-bash">Server version: Apache/2.4.9 (Unix) Server built: Jun 28 2014 12:11:10  
</code></pre>

<p>Which is actually not that bad. Apache is one of those softwares that updates rather slowly, 2.4.10 was released on July 10th. Since Apache is included in OS X we can just use that right? Sure, just visit this link: <a href="http://localhost/">http://localhost</a>. Oops, does your screen look something like this?</p>

<p><img src="https://iyware.com/content/images/import/unabletoconnect-960x600.png" alt="localhost: Unable to connect"></p>

<p>That’s because even though Apache is included in OS X it’s off by default. We have a few options available that we’ll look at to enabling Apache.</p>

<h3 id="theappleway">The Apple Way</h3>

<p>Even though Apple includes Apache as a part of OS X, and they used to include an option to enable it in the "Sharing" pane of System preferences, the preferred way to enable Apache on OS X since 10.7 is to <a href="http://www.apple.com/osx/server/">buy the Server app</a> from the App Store. That’s right, for only $19 Apple will sell you a button that starts Apache.</p>

<h3 id="thepoormansway">The Poor Man’s Way</h3>

<p>The second option is to simply start Apache ourselves. Go to terminal and type this command:</p>

<pre><code class="language-bash">sudo apachectl start  
</code></pre>

<p>After you type your password head back to <a href="http://loclahost/">http://localhost</a> and it should look more like this:</p>

<p><img src="https://iyware.com/content/images/import/itworks-960x600.png" alt="it works!"></p>

<p>$20 bucks for that. To be fair to Apple, Server does give you lots of other functionality but for our purposes they’re not really necessary. Kind of like installing XCode to use git. Now, I’m going to recommend that you actually stop the Apache service because we are not going to use the built in version that Apple ships with.</p>

<pre><code class="language-bash">sudo apachectl stop  
</code></pre>

<h3 id="thehomebrewway">The Homebrew Way</h3>

<p>The reason we’re not going to use the version that ships with Apple is because they do a TON of customization to the Apache configurations and it makes it really difficult to simply add a vhost or edit a config. You even have to mess with groups to allow yourself to change files in your ~/Sites folder. Instead we’re going to install Apache via Homebrew and it will run entirely within your home folder.</p>

<p>First we need to unload the OS X version of Apache which is loaded on the machine at startup, but "stopped". Copy and paste this into terminal.</p>

<pre><code class="language-bash">sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist 2&gt;/dev/null  
</code></pre>

<p>Next we need to do is add the Apache repository to the list of repositories that Homebrew tracks, as it is not included by default.</p>

<pre><code class="language-bash">brew tap homebrew/apache  
</code></pre>

<p>and you’ll see that the repository is downloaded and 9 new forumlae are available for install.</p>

<pre><code class="language-bash">brew tap homebrew/apache  
Cloning into '/usr/local/Library/Taps/homebrew/homebrew-apache'...  
remote: Counting objects: 241, done.  
remote: Total 241 (delta 0), reused 0 (delta 0)  
Receiving objects: 100% (241/241), 45.55 KiB | 39.00 KiB/s, done.  
Resolving deltas: 100% (130/130), done.  
Checking connectivity... done.  
Tapped 9 formulae  
</code></pre>

<p>The new repository gives us two versions of Apache: 2.2 and 2.4. For our development we will be installing Apache 2.4, however when we try we end up with an error:</p>

<pre><code class="language-bash">brew install httpd24  
Error: No available formula for apr (dependency of httpd24)  
Searching taps...  
homebrew/dupes/apr-util homebrew/dupes/apr homebrew/science/reapr  
</code></pre>

<p>it seems that Apache 2.4 requires another app called ‘apr’ that isn’t on our system. Fortunately Homebrew does us a favor and tells us where to find it and it’s available in another repository, so we need to add that to our list of available repositories like before:</p>

<pre><code class="language-bash">brew tap homebrew/dupes  
</code></pre>

<p>According to the <a href="https://github.com/Homebrew/homebrew-dupes">‘dupes’ repository</a>, "These formulae duplicate software provided by OS X, though may provide more recent or bugfix versions." Now what’s nice is that homebrew will resolve dependencies for us now that it knows where the files are, so let’s try again:</p>

<pre><code class="language-bash">brew install httpd24 –with-privileged-ports  
</code></pre>

<p><code>httpd24</code> will get us the current version of Apache 2.4. The ‘with-privileged-ports’ parameter tells Apache to run on port 80/443 instead of 8080/8443. Essentially this means you can visit <a href="http://localhost/">http://localhost</a> instead of having to type <a href="http://localhost:8080/">http://localhost:8080</a>. 80 and 443 are the default ports that all websites run on and for our development purposes are preferable.</p>

<p>If you get an error during compiling please follow the instructions of the output. If you have installed a beta version of Xcode on your machine please do NOT open an issue with the Homebrew people (like <a href="https://github.com/Homebrew/homebrew/issues/31217">this one</a>). Instead head over to the App Store and redownload the old version. If the app store won’t let you download you can go to the <a href="https://developer.apple.com/downloads/">Apple Developer Downloads</a> page and download the latest stable version of Xcode to your machine. You don’t have to remove the beta version, but the stable needs to be named ‘Xcode.app’.</p>

<pre><code class="language-bash">Error: Homebrew doesn't know what compiler versions ship with your version of Xcode (6.0).  
Please `brew update` and if that doesn't help, file an issue with the output of `brew --config`:  
https://github.com/Homebrew/homebrew/issues  
Note that we only track stable, released versions of Xcode. Thanks!  
READ THIS:  
https://github.com/Homebrew/homebrew/wiki/troubleshooting  
If reporting this issue please do so at (not Homebrew/homebrew):  
https://github.com/homebrew/homebrew-apache/issues  
</code></pre>

<p>Another issue I ran into was a configure failure because zlib couldn’t be found:</p>

<pre><code class="language-bash">brew install httpd24 --with-privileged-ports  
==&gt; Downloading https://archive.apache.org/dist/httpd/httpd-2.4.10.tar.bz2 
Already downloaded: /Library/Caches/Homebrew/httpd24-2.4.10.tar.bz2  
==&gt; ./configure --enable-layout=Homebrew --enable-mods-shared=all --with-mpm=pre 
checking whether to enable mod_sed... shared (all) checking whether to enable mod_charset_lite... shared (all)  
checking whether to enable mod_deflate...  
checking dependencies  
checking for zlib location... not found  
checking whether to enable mod_deflate...  
configure: error: mod_deflate has been requested but can not be built due to prerequisite failures  
READ THIS:  
https://github.com/Homebrew/homebrew/wiki/troubleshooting If reporting this issue please do so at (not Homebrew/homebrew):  
https://github.com/homebrew/homebrew-apache/issues  
</code></pre>

<p>This is probably a result of using a beta version of the Xcode command line tools, but there’s a simple fix that’s <a href="https://github.com/Homebrew/homebrew-apache/issues/30">been reported</a>. First you need to install zlib in Homebrew from the dupes repository.</p>

<pre><code class="language-bash">brew install zlib  
</code></pre>

<p>Homebrew will give you this caveat:</p>

<pre><code class="language-bash">==&gt; Caveats 
This formula is keg-only, so it was not symlinked into /usr/local.  
Mac OS X already provides this software and installing another version in parallel can cause all kinds of trouble.  
Generally there are no consequences of this for you.  
If you build your own software and it requires this formula, you'll need to add to your build variables:  
LDFLAGS: -L/usr/local/opt/zlib/lib  
CPPFLAGS: -I/usr/local/opt/zlib/include  
</code></pre>

<p>Which basically means that you need to manually use that version of zlib, which is what we’ll tell our Apache build script to do now. Go back to terminal and enter the following command:</p>

<pre><code class="language-bash">brew edit httpd24  
</code></pre>

<p>This will open the config in your default text editor. Enter this line:</p>

<pre><code class="language-ruby">args &lt;&lt; "--with-z=/usr/local/Cellar/zlib/1.2.8"  
</code></pre>

<p>After this section:</p>

<pre><code class="language-ruby">if build.with? "privileged-ports"  
  args &lt;&lt; "--with-port=80"
  args &lt;&lt; "--with-sslport=443"
else  
  args &lt;&lt; "--with-port=8080"
  args &lt;&lt; "--with-sslport=8443"
end  
</code></pre>

<p>That will add a new argument that forces it to use our Homebrew version of zlib. Save the file and run the build again:</p>

<pre><code class="language-bash">brew install httpd24 --with-privileged-ports  
</code></pre>

<p>If you don't have any errors then your output should look something like this:</p>

<pre><code class="language-bash">brew install httpd24 --with-privileged-ports  
==&gt; Downloading https://archive.apache.org/dist/httpd/httpd-2.4.10.tar.bz2 
Already downloaded: /Library/Caches/Homebrew/httpd24-2.4.10.tar.bz2  
==&gt; ./configure --enable-layout=Homebrew --enable-mods-shared=all --with-mpm=pre 
==&gt; make 
==&gt; make install 
==&gt; Caveats 
To have launchd start httpd24 at login:  
ln -sfv /usr/local/opt/httpd24/*.plist ~/Library/LaunchAgents  
Then to load httpd24 now:  
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.httpd24.plist  
==&gt; Summary /usr/local/Cellar/httpd24/2.4.10: 199 files, 4.4M, built in 86 seconds
</code></pre>

<p>Finally it's important that we look at the caveats as they will tell us how to make sure that Apache starts when we log in to the system. Since we used the <code>--with-privileged-ports</code> parameter we will have to make some adjustments to the recommendations that Homebrew provides. Their recommendation is to create a symlink to your user LaunchAgents folder. That folder contains plists that do certain things when you log in. However, on a Unix system lower ports like 80 require root to run. Since this launch agent is launching Apache under your username it will quietly fail. Instead we will have the system (root) load it for us. The biggest difference is that Apache will be loaded at system start instead of when you log in. So go ahead and copy and paste this modified command into terminal.</p>

<pre><code class="language-bash">sudo ln -sfv /usr/local/opt/httpd24/*.plist /Library/LaunchDaemons; sudo launchctl load /Library/LaunchDaemons/homebrew.mxcl.httpd24.plist  
</code></pre>

<p>Now the next time you reboot Apache will load. But the beautiful thing about a service is that you can start, stop, or reload it at any time- we don't <em>need</em> to log out and log in again to start. Now, since we're running Apache as root we will need to use <code>sudo</code>. So it's not necessary now, because we just loaded it, but for the future you can use:</p>

<pre><code class="language-bash">sudo httpd -k start  
sudo httpd -k restart  
sudo httpd -k stop  
</code></pre>

<p>for more info you can check the manual <code>man</code> entry that's included with our Apache install.</p>

<pre><code class="language-bash">man httpd  
</code></pre>

<p>Now Apache is installed (by you) and running (as root). Go ahead and go back to <a href="http://localhost/">http://localhost</a> and you should see this:</p>

<p><img src="https://iyware.com/content/images/import/itworks1-960x600.png" alt="Apache is Installed"></p>

<p>By default the Apache configuration files are stored in <code>/usr/local/etc/apache2/2.4</code> and the web root is at <code>/usr/local/var/www/htdocs</code>. We'll revisit further Apache configuration when we get to Moodle setup, but for now enjoy your shiny new site!</p>

<h2 id="mysqluhhpostgresql">MySQL, uhh.. PostgreSQL</h2>

<p>The next step on setting up our MA*P server is the database. In the old, olden days of 3 years ago OS X included MySQL in OS X server. Then Apple switched to Postgres. Then Apple bundled Postgres with the OS and added an 'enable' button in the Server app (a la Apache). And now starting with OS 10.9 it's back to being bundled exclusively with the Server App. tl;dr: you need to install a database, and I figure if it's so trivial for Apple to switch databases then it doesn't really matter which one we're using right ;)</p>

<p>Ok, here's the exception, if you're planning on developing some sort of Moodle plugin, or fixing bugs that are database oriented, then you'll probably want to install multiple database drivers. But for simpler development where Moodle $DB handled the transactions, pick your poison. I'm going to use MySQL. So let's head back to the Homebrew app in terminal and get started:</p>

<pre><code class="language-bash">brew install mysql  
</code></pre>

<p>Ok, caveat. If you happen to be on an as-of-yet-unreleased OS and have both Xcode 5 and Xcode 6 beta installed on your system you will need to use Xcode 6 to install MySQL otherwise this will happen:</p>

<pre><code class="language-bash">brew install mysql  
==&gt; Installing dependencies for mysql: cmake, pkg-config, makedepend, ope 
==&gt; Installing mysql dependency: cmake 
==&gt; Downloading http://www.cmake.org/files/v3.0/cmake-3.0.0.tar.gz 
######################################################################## 100.0% 
==&gt; ./bootstrap --prefix=/usr/local/Cellar/cmake/3.0.0 --system-libs --no-system 
See also "/tmp/cmake-Lgaj/cmake-3.0.0/CMakeFiles/CMakeError.log".  
--------------------------------------------- 
Error when bootstrapping CMake: Problem while running initial CMake  
--------------------------------------------- 
READ THIS: https://github.com/Homebrew/homebrew/wiki/troubleshooting 

These open issues may also help:  
Qt5 Cmake Files Incorrect (https://github.com/Homebrew/homebrew/issues/29938)  
Fix LLVM CMake modules not being preprocessed (https://github.com/Homebrew/homebrew/pull/29976)  
glm: Does not install FindGLM.cmake (https://github.com/Homebrew/homebrew/issues/28403)  
cmake builds fail on CLT-only with --env=std (https://github.com/Homebrew/homebrew/issues/29101)  
cmake find_package(PythonLibs)  
broken with brewed python on 10.9 (https://github.com/Homebrew/homebrew/issues/25118)  
</code></pre>

<p>It's nice that they give you a log to inspect, but it's also kind of annoying that the /tmp dir gets cleaned up one it's done failing... Basically if you can capture the log in Console while it's failing you'll see that something in the Xcode tool is causing the failure. I guessed that it was because of Xcode 5 - and hey, lucky guess! So if you have that error drop into terminal and use this command:</p>

<pre><code class="language-bash">mv /Applications/Xcode.app /Applications/Xcode5.app; mv /Applications/Xcode6-beta4.app /Applications/Xcode.app  
</code></pre>

<p>Or just go to the /Applications folder and rename them, your choice. Then run the install command again. When the build is done you can move your Xcode apps back to their original names. If all goes well you should end up with some terminal output like this:</p>

<pre><code class="language-bash">brew install mysql  
==&gt; Installing dependencies for mysql: cmake, pkg-config, makedepend, ope 
==&gt; Installing mysql dependency: cmake 
==&gt; Downloading http://www.cmake.org/files/v3.0/cmake-3.0.0.tar.gz 
Already downloaded: /Library/Caches/Homebrew/cmake-3.0.0.tar.gz  
==&gt; ./bootstrap --prefix=/usr/local/Cellar/cmake/3.0.0 --system-libs --no-system 
==&gt; make 
==&gt; make install /usr/local/Cellar/cmake/3.0.0: 1622 files, 25M, built in 4.1 minutes 
==&gt; Installing mysql dependency: pkg-config 
==&gt; Downloading http://pkgconfig.freedesktop.org/releases/pkg-config-0.28.tar.gz
######################################################################## 100.0% 
==&gt; ./configure --prefix=/usr/local/Cellar/pkg-config/0.28 --disable-host-tool - 
==&gt; make 
==&gt; make check 
==&gt; make install /usr/local/Cellar/pkg-config/0.28: 10 files, 608K, built in 89 seconds 
==&gt; Installing mysql dependency: makedepend 
==&gt; Downloading http://xorg.freedesktop.org/releases/individual/util/makedepend- 
######################################################################## 100.0% 
==&gt; Downloading http://xorg.freedesktop.org/releases/individual/proto/xproto-7.0 
######################################################################## 100.0% 
==&gt; ./configure --disable-silent-rules --prefix=/private/tmp/makedepend-xfpn/mak 
==&gt; make install 
==&gt; Downloading http://xorg.freedesktop.org/releases/individual/util/util-macros
######################################################################## 100.0% 
==&gt; ./configure --prefix=/private/tmp/makedepend-xfpn/makedepend-1.0.5/xorg-macr 
==&gt; make install 
==&gt; ./configure --disable-silent-rules --prefix=/usr/local/Cellar/makedepend/1.0 
==&gt; make install /usr/local/Cellar/makedepend/1.0.5: 7 files, 92K, built in 27 seconds 
==&gt; Installing mysql dependency: openssl 
==&gt; Downloading https://www.openssl.org/source/openssl-1.0.1h.tar.gz curl: (28) Operation timed out after 6190 milliseconds with 0 out of 0 bytes received Trying a mirror... 
==&gt; Downloading http://mirrors.ibiblio.org/openssl/source/openssl-1.0.1h.tar.gz
######################################################################## 100.0% 
==&gt; perl ./Configure --prefix=/usr/local/Cellar/openssl/1.0.1h --openssldir=/usr 
==&gt; make depend 
==&gt; make 
==&gt; make test 
==&gt; make install MANDIR=/usr/local/Cellar/openssl/1.0.1h/share/man MANSUFFIX=ssl 
==&gt; Caveats 
A CA file has been bootstrapped using certificates from the system keychain.  
To add additional certificates, place .pem files in  
/usr/local/etc/openssl/certs 
and run  
/usr/local/opt/openssl/bin/c_rehash 
This formula is keg-only, so it was not symlinked into /usr/local.  
Mac OS X already provides this software and installing another version in parallel can cause all kinds of trouble.  
The OpenSSL provided by OS X is too old for some software.  
Generally there are no consequences of this for you.  
If you build your own software and it requires this formula, you'll need to add to your build variables:  
LDFLAGS: -L/usr/local/opt/openssl/lib  
CPPFLAGS: -I/usr/local/opt/openssl/include  
==&gt; Summary /usr/local/Cellar/openssl/1.0.1h: 429 files, 15M, built in 4.1 minutes 
==&gt; Installing mysql 
==&gt; Downloading http://cdn.mysql.com/Downloads/MySQL-5.6/mysql-5.6.20.tar.gz
######################################################################## 100.0% 
==&gt; cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/Cellar/mysql/5.6.20 -DCMAKE_FIND_F 
==&gt; make 
==&gt; make install 
==&gt; Caveats 
A "/etc/my.cnf" from another install may interfere with a Homebrew-built server starting up correctly.  
To connect:  
mysql -uroot  
To have launchd start mysql at login:  
ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents  
Then to load mysql now:  
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist  
Or, if you don't want/need launchctl, you can just run:  
mysql.server start  
==&gt; /usr/local/Cellar/mysql/5.6.20/bin/mysql_install_db --verbose --user=dannywa 
==&gt; Summary /usr/local/Cellar/mysql/5.6.20: 9578 files, 339M, built in 7.2 minutes
</code></pre>

<p>Now that's pretty amazing to me, and where homebrew is really worth its salt. All of those dependencies managed, auto downloaded, configured, and installed: cmake, pkg-config, makedepend, openssl, and finally mysql. There's no way I could have done that in 7.2 minutes manually.</p>

<p>Generally MySQL runs at a high enough port that it can run in user space, so you don't need to sudo it into the /Library/LaunchAgents folder, it's ok to run it from your home folder, so go ahead and follow the instruction on screen:</p>

<pre><code class="language-bash">ln -sfv /usr/local/opt/mysql/*.plist ~/Library/LaunchAgents;  
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mysql.plist  
</code></pre>

<p>That will load MySQL. Now we'll test it and make some configuration changes. In shell we will connect to the mysql server:</p>

<pre><code class="language-bash">mysql -u root  
</code></pre>

<p>You will now drop into a MySQL prompt that should look something like this:</p>

<pre><code class="language-bash">Welcome to the MySQL monitor. Commands end with ; or \g.  
Your MySQL connection id is 3  
Server version: 5.6.20 Homebrew 

Copyright (c) 2000, 2014, Oracle and/or its affiliates. All rights reserved. 

Oracle is a registered trademark of Oracle Corporation and/or its affiliates. Other names may be trademarks of their respective owners. 

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement. 

mysql&gt;  
</code></pre>

<p>Notice that we have version 5.6.20 Homebrew - helpful in identifying that we are connected to the <em>correct</em> database. Now at the prompt (<code>mysql &gt;</code>) we will set a password for the root account. It's not only good practice, it's required by some software. Obviously in a production server you would worry about security- but for a dev server using root is A-OK in my book. To set the root password enter this command:</p>

<pre><code class="language-sql">exit;  
</code></pre>

<p>No, that didn't really change the root password. That simply disconnected from the MySQL server and dropped us back into our standard shell. You see, there's a simple command called <code>mysqladmin</code> that's been installed for us as well which makes it much easier to change the password. Now we will use this command:</p>

<pre><code class="language-bash">mysqladmin -u root password "newpwd"  
</code></pre>

<p>Please substitute "newpwd" for the password you want to use for the root account. I use "root" (no quotes). Again- it's a dev. server. Remember that the MySQL docs recommend only alphanumeric characters for MySQL passwords. If you run into log in issues later it might be because of special characters. Now, let's try to connect to mysql again as above and you should get an error:</p>

<pre><code class="language-bash">mysql -u root ERROR 1045 (28000): Access denied for user 'root'@'localhost' (using password: NO)  
</code></pre>

<p>If you want to connect via terminal in the future you will have to use the <code>-p</code> flag like so:</p>

<pre><code class="language-bash">mysql -u root -p  
</code></pre>

<p>After which you will be prompted for the password which you just set.</p>

<p>For now that's the basic configuration of MySQL, we'll cover creating databases later when we go into Moodle setup.</p>

<h2 id="php">PHP</h2>

<p><a href="http://php.net/">PHP</a> is one of the most popular dynamic languages out there. It's robust, it's solid, and it's what Moodle uses. So let's install it. Once again, OS X ships with PHP installed, but we're going to disable it and replace with the Homebrew version. My shipped version is 5.5.9 (cli) which was released on Feb 4, 2014. The latest stable version is 5.5.15:</p>

<pre><code class="language-bash">php -v  
PHP 5.5.9 (cli) (built: Jun 28 2014 15:59:38)  
Copyright (c) 1997-2014 The PHP Group  
Zend Engine v2.5.0, Copyright (c) 1998-2014 Zend Technologies  
</code></pre>

<p>Now, before we install PHP we need to remember that Moodle requires and recommends a lot of submodules:</p>

<ul>
<li>php</li>
<li>pcreunicode</li>
<li>php_extension iconv</li>
<li>php_extension mbstring</li>
<li>php_extension curl</li>
<li>php_extension openssl</li>
<li>php_extension tokenizer</li>
<li>php_extension xmlrpc</li>
<li>php_extension soap</li>
<li>php_extension ctype</li>
<li>php_extension zip</li>
<li>php_extension zlib</li>
<li>php_extension gd</li>
<li>php_extension simplexml</li>
<li>php_extension spl</li>
<li>php_extension pcre</li>
<li>php_extension dom</li>
<li>php_extension xml</li>
<li>php_extension intl</li>
<li>php_extension json</li>
<li>php_extension hash</li>
</ul>

<p>Man that's a lot of requirements/recommendations, fortunately Homebrew is going to provide us a lot of flexibility in getting everything installed. First we're going to need to tap two new repositories 'versions' and 'homebrew-php':</p>

<pre><code class="language-bash">brew tap homebrew/versions; brew tap homebrew/homebrew-php  
</code></pre>

<p>If everything goes well your output should look something like this:</p>

<pre><code class="language-bash">brew tap homebrew/versions  
Cloning into '/usr/local/Library/Taps/homebrew/homebrew-versions'...  
remote: Counting objects: 2274, done.  
remote: Compressing objects: 100% (42/42), done.  
remote: Total 2274 (delta 18), reused 4 (delta 2) Receiving objects: 100% (2274/2274), 729.39 KiB | 338.00 KiB/s, done.  
Resolving deltas: 100% (1278/1278), done.  
Checking connectivity... done.  
Tapped 160 formulae  
brew tap homebrew/homebrew-php  
Cloning into '/usr/local/Library/Taps/homebrew/homebrew-php'...  
remote: Counting objects: 6685, done.  
remote: Compressing objects: 100% (5/5), done.  
remote: Total 6685 (delta 0), reused 1 (delta 0)  
Receiving objects: 100% (6685/6685), 1.32 MiB | 691.00 KiB/s, done.  
Resolving deltas: 100% (4322/4322), done.  
Checking connectivity... done.  
Tapped 408 formulae  
</code></pre>

<p>Next you'll need to decide which version of PHP you want. I'm going to use PHP 5.6 even though it's only at RC1 as of this writing because I really want to try <a href="http://phpdbg.com/">phpdbg</a>. If nobody tests release versions of software then how will the bugs be found? Let's take a look at what options are available to us by running this command:</p>

<pre><code class="language-bash">brew options php56  
</code></pre>

<p>and we get quite a few options:</p>

<pre><code class="language-bash">brew options php56  
--disable-opcache 
  Build without Opcache extension 
--homebrew-apxs 
  Build against apxs in Homebrew prefix
--with-apache 
  Enable building of shared Apache 2.0 Handler module, overriding any options which disable apache 
--with-cgi 
  Enable building of the CGI executable (implies --without-apache) 
--with-debug 
  Compile with debugging symbols 
--with-fpm 
  Enable building of the fpm SAPI executable (implies --without-apache) 
--with-gmp 
  Build with gmp support 
--with-homebrew-curl 
  Include Curl support via Homebrew 
--with-homebrew-libxslt 
  Include LibXSLT support via Homebrew 
--with-homebrew-openssl 
  Include OpenSSL support via Homebrew 
--with-imap Include 
  IMAP extension 
--with-intl 
  Include internationalization support 
--with-libmysql 
  Include (old-style) libmysql support instead of mysqlnd 
--with-mssql 
  Include MSSQL-DB support 
--with-pdo-oci 
  Include Oracle databases (requries ORACLE_HOME be set) 
--with-pgsql 
  Include PostgreSQL support 
--with-phpdbg 
  Enable building of the phpdbg SAPI executable (PHP 5.4 and above) 
--with-thread-safety 
  Build with thread safety 
--with-tidy 
  Include Tidy support 
--without-bz2 
  Build without bz2 support 
--without-mysql 
  Remove MySQL/MariaDB support 
--without-pcntl 
  Build without Process Control support 
--without-pear 
  Build without PEAR --HEAD install HEAD version
</code></pre>

<p>Even though it's probably not required for php56 I'm going to use the <code>--with-phpdbg</code> flag just to be safe. In addition I'm going to use a few other options for homebrew versions of software. Since we've already installed Homebrew OpenSSL we'll use that, as well as APXS and Curl. Apxs is a tool for building Apache modules (like PHP) - since we're using a newer version of Apache than shipped with OS X we should probably use a newer version of APXS too. Curl is another one of those tools that's slightly outdated and we may as well use the latest stable version. The version on my system is 7.30.0, and at the time of this writing the version shipping with Homebrew is 7.37.1. I've also used <code>--with-tidy</code> because if I recall correctly Moodle text editors can leverage it for WYSIWYG input. Finally, notice that we're not using the <code>--with-intl</code> flag, that's because currently intl is broken and we'll have to install a separate package after PHP builds. Here's my full install command (copy and paste):</p>

<pre><code class="language-bash">brew install php56 --homebrew-apxs --with-apache --with-homebrew-curl --with-homebrew-openssl --with-phpdbg --with-tidy  
</code></pre>

<p>If you get an error about missing bzip2 like this:</p>

<pre><code class="language-bash">==&gt; ./configure --prefix=/usr/local/Cellar/php56/5.6.0-rc.2 --localstatedir=/usr 
checking for gzgets in -lz... yes  
checking whether to enable bc style precision math functions... yes  
checking for BZip2 support... yes  
checking for BZip2 in default path... not found  
configure: error: Please reinstall the BZip2 distribution  
READ THIS: https://github.com/Homebrew/homebrew/wiki/troubleshooting  
If reporting this issue please do so at (not Homebrew/homebrew): https://github.com/homebrew/homebrew-php/issues  
/System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in 'require': Class is not a module (TypeError) 
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in 'require'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/net/http.rb:390:in '&lt;http&gt;'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/net/http.rb:384:in '&lt;net&gt;'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/net/http.rb:25:in '&lt;top&gt;'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in 'require'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in 'require'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/net/https.rb:21:in '&lt;top&gt;'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in 'require'  
from /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:55:in 'require'  
from /usr/local/Library/Homebrew/utils.rb:308:in 'open'  
from /usr/local/Library/Homebrew/utils.rb:350:in 'issues_matching' from /usr/local/Library/Homebrew/utils.rb:378:in 'issues_for_formula'  
from /usr/local/Library/Homebrew/exceptions.rb:171:in 'fetch_issues' from /usr/local/Library/Homebrew/exceptions.rb:167:in 'issues'  
from /usr/local/Library/Homebrew/exceptions.rb:207:in 'dump' from /usr/local/Library/brew.rb:158:in 'rescue in &lt;main&gt;'  
from /usr/local/Library/brew.rb:66:in '&lt;main&gt;'&lt;/main&gt;&lt;/main&gt;&lt;/top&gt;&lt;/top&gt;&lt;/net&gt;&lt;/http&gt;  
</code></pre>

<p>Then you will need to edit the formula to set the path of your bzip2 binary manually. First, find where your bzip2 binary is located with the following command:</p>

<pre><code class="language-bash">which bzip2  
</code></pre>

<p>Then edit the forumula for php:</p>

<pre><code class="language-bash">brew edit php56  
</code></pre>

<p>and add this line:</p>

<pre><code class="language-bash">args &lt;&lt; "--with-bz2=/usr/bin/bzip2"  
</code></pre>

<p>after these lines:</p>

<pre><code class="language-bash">def install_args args = super  
</code></pre>

<p>Another common error that seems to be occuring, and has been reported (<a href="https://github.com/Homebrew/homebrew-php/issues/1268">here</a>) is a compilation error while building phar. The basic error is:</p>

<pre><code class="language-bash">make: *** [ext/phar/phar.phar] Illegal instruction: 4  
</code></pre>

<p>or</p>

<pre><code class="language-bash">/Library/Ruby/Site/2.0.0/rubygems/core_ext/kernel_require.rb:55:in require': Class is not a module (TypeError)
</code></pre>

<p>I found this to be an error of trying to use Homebrew's OpenSSL, either by setting it as the default on the system or using the <code>--with-homebrew-ssl</code> flag. So for now my build is using the system version of OpenSSL. If the build goes correctly then your total output should look something like this:</p>

<pre><code class="language-bash">brew install php56 --homebrew-apxs --with-apache --with-homebrew-curl  --with-phpdbg --with-tidy  
==&gt; Installing dependencies for php56: curl, libpng, freetype, xz, gettex
==&gt; Installing php56 dependency: curl
==&gt; Downloading http://curl.haxx.se/download/curl-7.37.1.tar.gz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/curl/7.37.1 --with-darwinssl --withou
==&gt; make install
==&gt; Caveats
This formula is keg-only, so it was not symlinked into /usr/local.

Mac OS X already provides this software and installing another version in  
parallel can cause all kinds of trouble.

Generally there are no consequences of this for you. If you build your  
own software and it requires this formula, you'll need to add to your  
build variables:

    LDFLAGS:  -L/usr/local/opt/curl/lib
    CPPFLAGS: -I/usr/local/opt/curl/include

==&gt; Summary
  /usr/local/Cellar/curl/7.37.1: 285 files, 2.8M, built in 91 seconds
==&gt; Installing php56 dependency: libpng
==&gt; Downloading https://downloads.sf.net/project/libpng/libpng16/1.6.12/libpng-1
######################################################################## 100.0%
==&gt; ./configure --disable-silent-rules --prefix=/usr/local/Cellar/libpng/1.6.12
==&gt; make install
  /usr/local/Cellar/libpng/1.6.12: 17 files, 1.2M, built in 24 seconds
==&gt; Installing php56 dependency: freetype
==&gt; Downloading https://downloads.sf.net/project/freetype/freetype2/2.5.3/freety
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/freetype/2.5.3_1 --without-harfbuzz
==&gt; make
==&gt; make install
  /usr/local/Cellar/freetype/2.5.3_1: 60 files, 2.5M, built in 26 seconds
==&gt; Installing php56 dependency: xz
==&gt; Downloading http://fossies.org/linux/misc/xz-5.0.5.tar.gz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/xz/5.0.5
==&gt; make install
  /usr/local/Cellar/xz/5.0.5: 58 files, 1.5M, built in 34 seconds
==&gt; Installing php56 dependency: gettext
==&gt; Downloading http://ftpmirror.gnu.org/gettext/gettext-0.19.2.tar.xz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/gettext/0.19.2 --with-included-gettex
==&gt; make
==&gt; make install
==&gt; Caveats
This formula is keg-only, so it was not symlinked into /usr/local.

OS X provides the BSD gettext library and some software gets confused if both are in the library path.

Generally there are no consequences of this for you. If you build your  
own software and it requires this formula, you'll need to add to your  
build variables:

    LDFLAGS:  -L/usr/local/opt/gettext/lib
    CPPFLAGS: -I/usr/local/opt/gettext/include

==&gt; Summary
  /usr/local/Cellar/gettext/0.19.2: 1920 files, 18M, built in 5.3 minutes
==&gt; Installing php56 dependency: jpeg
==&gt; Downloading http://www.ijg.org/files/jpegsrc.v8d.tar.gz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/jpeg/8d
==&gt; make install
  /usr/local/Cellar/jpeg/8d: 18 files, 780K, built in 21 seconds
==&gt; Installing php56 dependency: autoconf
==&gt; Downloading http://ftpmirror.gnu.org/autoconf/autoconf-2.69.tar.gz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/autoconf/2.69
==&gt; make install
  /usr/local/Cellar/autoconf/2.69: 70 files, 3.1M, built in 28 seconds
==&gt; Installing php56 dependency: automake
==&gt; Downloading http://ftpmirror.gnu.org/automake/automake-1.14.1.tar.gz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/automake/1.14.1
==&gt; make install
  /usr/local/Cellar/automake/1.14.1: 131 files, 3.2M, built in 37 seconds
==&gt; Installing php56 dependency: libtool
==&gt; Downloading http://ftpmirror.gnu.org/libtool/libtool-2.4.2.tar.gz
######################################################################## 100.0%
==&gt; Patching
patching file libltdl/config/ltmain.sh  
==&gt; ./configure --prefix=/usr/local/Cellar/libtool/2.4.2 --program-prefix=g --en
==&gt; make install
==&gt; Caveats
In order to prevent conflicts with Apple's own libtool we have prepended a "g"  
so, you have instead: glibtool and glibtoolize.  
==&gt; Summary
  /usr/local/Cellar/libtool/2.4.2: 69 files, 2.5M, built in 46 seconds
==&gt; Installing php56 dependency: homebrew/dupes/tidy
==&gt; Downloading ftp://mirror.internode.on.net/pub/gentoo/distfiles/tidy-20090325
######################################################################## 100.0%
==&gt; sh build/gnuauto/setup.sh
==&gt; ./configure --prefix=/usr/local/Cellar/tidy/20090325 --mandir=/usr/local/Cel
==&gt; make install
  /usr/local/Cellar/tidy/20090325: 10 files, 940K, built in 43 seconds
==&gt; Installing php56 dependency: unixodbc
==&gt; Downloading http://www.unixodbc.org/unixODBC-2.3.2.tar.gz
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/unixodbc/2.3.2 --enable-gui=no
==&gt; make install
  /usr/local/Cellar/unixodbc/2.3.2: 31 files, 960K, built in 2.4 minutes
==&gt; Installing php56
==&gt; Downloading http://downloads.php.net/tyrael/php-5.6.0RC3.tar.bz2
######################################################################## 100.0%

Warning: Backing up all known pear.conf and .pearrc files  
Warning: If you have a pre-existing pear install outside  
         of homebrew-php, or you are using a non-standard
         pear.conf location, installation may fail.
==&gt; ./configure --prefix=/usr/local/Cellar/php56/5.6.0-rc.3 --localstatedir=/usr
==&gt; make
==&gt; make install
==&gt; /usr/local/Cellar/php56/5.6.0-rc.3/bin/pear config-set php_ini /usr/local/et
==&gt; Caveats
To enable PHP in Apache add the following to httpd.conf and restart Apache:  
    LoadModule php5_module    /usr/local/opt/php56/libexec/apache2/libphp5.so

The php.ini file can be found in:  
    /usr/local/etc/php/5.6/php.ini

✩✩✩✩ PEAR ✩✩✩✩

If PEAR complains about permissions, 'fix' the default PEAR permissions and config:  
    chmod -R ug+w /usr/local/Cellar/php56/5.6.0-rc.3/lib/php
    pear config-set php_ini /usr/local/etc/php/5.6/php.ini

✩✩✩✩ Extensions ✩✩✩✩

If you are having issues with custom extension compiling, ensure that  
you are using the brew version, by placing /usr/local/bin before /usr/sbin in your PATH:

      PATH="/usr/local/bin:$PATH"

PHP56 Extensions will always be compiled against this PHP. Please install them  
using --without-homebrew-php to enable compiling against system PHP.

✩✩✩✩ PHP CLI ✩✩✩✩

If you wish to swap the PHP you use on the command line, you should add the following to ~/.bashrc,  
~/.zshrc, ~/.profile or your shell's equivalent configuration file:

      export PATH="$(brew --prefix homebrew/php/php56)/bin:$PATH"

To have launchd start php56 at login:  
    ln -sfv /usr/local/opt/php56/*.plist ~/Library/LaunchAgents
Then to load php56 now:  
    launchctl load ~/Library/LaunchAgents/homebrew.mxcl.php56.plist
==&gt; Summary
  /usr/local/Cellar/php56/5.6.0-rc.3: 497 files, 50M, built in 5.9 minutes
</code></pre>

<p>As you can see looking at the caveats there are still a few steps we need to do. First we will fix the PEAR permissions, this might not be necessary, but it won't hurt anything so go ahead and copy and paste these commands into the terminal:</p>

<pre><code class="language-bash">chmod -R ug+w /usr/local/Cellar/php56/5.6.0-rc.3/lib/php  
pear config-set php_ini /usr/local/etc/php/5.6/php.ini  
</code></pre>

<p>Next we'll make sure that PHP gets loaded at login by the launchd and load it now, too:</p>

<pre><code class="language-bash">ln -sfv /usr/local/opt/php56/*.plist ~/Library/LaunchAgents  
launchctl load ~/Library/LaunchAgents/homebrew.mxcl.php56.plist  
</code></pre>

<p>Then we'll check our command line version. First, exit or Quit Terminal and reopen it, then run this command in terminal:</p>

<pre><code class="language-bash">php -v  
</code></pre>

<p>The output should have 5.6 listed as the version, like this:</p>

<pre><code class="language-bash">php -v  
PHP 5.6.0RC3 (cli) (built: Aug 7 2014 10:21:55)  
Copyright (c) 1997-2014 The PHP Group  
Zend Engine v2.6.0-dev, Copyright (c) 1998-2014 Zend Technologies  
</code></pre>

<p>If it lists 5.5 as the version then you need to update you <code>$PATH</code> variable. Depending on the version of shell your're running you need to add the following line to your terminal config (default ~/.profile). The following commands should add it for you:</p>

<pre><code class="language-bash">touch ~/.profile  
cat &gt;&gt; ~/.profile &lt;&lt;EOF  
export PATH="$(brew --prefix homebrew/php/php56)/bin:$PATH"  
EOF  
</code></pre>

<p>Now you can exit Terminal and reopen it and run <code>php -v</code> again.</p>

<p>Finally you need to add the php handlers to the httpd.conf. Open up <code>/usr/local/etc/apache2/2.4/httpd.conf</code> and add the following three lines to the document:</p>

<pre><code class="language-apacheconf">LoadModule php5_module /usr/local/opt/php56/libexec/apache2/libphp5.so  
AddHandler php5-script .php  
AddType text/html .php  
</code></pre>

<p>and find the line that starts with <code>DirectoryIndex</code> and change it to read:</p>

<pre><code class="language-apacheconf">DirectoryIndex index.php /  
</code></pre>

<p>Save the document and then restart the httpd service with the following command:</p>

<pre><code class="language-bash">sudo httpd -k restart  
</code></pre>

<p>Now we having functioning PHP on our server, but remember we need to install <code>intl</code> separately, so go back to terminal and run the following command:</p>

<pre><code class="language-bash">brew install php56-intl  
</code></pre>

<p>When it finishes building you should have output similar to this:</p>

<pre><code class="language-bash">brew install php56-intl  
==&gt; Installing php56-intl dependency: icu4c
==&gt; Downloading http://download.icu-project.org/files/icu4c/52.1/icu4c-52_1-src.
######################################################################## 100.0%
==&gt; ./configure --prefix=/usr/local/Cellar/icu4c/52.1 --disable-samples --disabl
==&gt; make VERBOSE=1
==&gt; make VERBOSE=1 install
==&gt; Caveats
This formula is keg-only, so it was not symlinked into /usr/local.

Conflicts; see: https://github.com/Homebrew/homebrew/issues/issue/167

Generally there are no consequences of this for you. If you build your  
own software and it requires this formula, you'll need to add to your  
build variables:

    LDFLAGS:  -L/usr/local/opt/icu4c/lib
    CPPFLAGS: -I/usr/local/opt/icu4c/include

==&gt; Summary
  /usr/local/Cellar/icu4c/52.1: 239 files, 60M, built in 2.6 minutes
==&gt; Installing php56-intl
==&gt; Downloading http://downloads.php.net/tyrael/php-5.6.0RC3.tar.bz2
######################################################################## 100.0%
==&gt; PHP_AUTOCONF="/usr/local/opt/autoconf/bin/autoconf" PHP_AUTOHEADER="/usr/loc
==&gt; ./configure --prefix=/usr/local/Cellar/php56-intl/5.6.0-rc.3 --with-php-conf
==&gt; make
==&gt; Caveats
To finish installing intl for PHP 5.6:  
  * /usr/local/etc/php/5.6/conf.d/ext-intl.ini was created,
    do not forget to remove it upon extension removal.
  * Validate installation via one of the following methods:
  *
  * Using PHP from a webserver:
  * - Restart your webserver.
  * - Write a PHP page that calls "phpinfo();"
  * - Load it in a browser and look for the info on the intl module.
  * - If you see it, you have been successful!
  *
  * Using PHP from the command line:
  * - Run "php -i" (command-line "phpinfo()")
  * - Look for the info on the intl module.
  * - If you see it, you have been successful!
==&gt; Summary
  /usr/local/Cellar/php56-intl/5.6.0-rc.3: 3 files, 360K, built in 52 seconds

brew install composer  
==&gt; Downloading http://getcomposer.org/download/1.0.0-alpha8/composer.phar
######################################################################## 100.0%
==&gt; Caveats
Verify your installation by running:  
  "composer --version".

You can read more about composer and packagist by running:  
  "brew home composer".
==&gt; Summary
  /usr/local/Cellar/composer/1.0.0-alpha8: 3 files, 952K, built in 3 seconds
</code></pre>

<p>And there we have it! That will give us every required Moodle php extension, except for opcache, which at the time of this writing is <a href="https://github.com/Homebrew/homebrew-php/issues/1100">not compatible with PHP 5.6</a>. When it does become available you can simply run <code>brew install php56-opcache</code> and you're done.</p>

<h2 id="wrappingup">Wrapping Up</h2>

<p>That's the end of the first part of this extensive walk through of setting up a Moodle development server. This first part should really help anyone doing any sort of PHP development on a Mac whether it's WordPress, Drupal, or whatever. In part two we'll dive into configuring Apache and MySQL for Moodle development as well how to use the MDK, git, and JIRA to contribute your code and bug fixes back to the community.</p>]]></description><link>https://iyware.com/osx-yosemite-mamp-homebrew-development-setup/</link><guid isPermaLink="false">30dbf1e7-e4cf-4997-84ef-d8fb05d78850</guid><category><![CDATA[DevOps]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Wed, 13 Aug 2014 11:17:52 GMT</pubDate></item><item><title><![CDATA[Elegance: What's coming?]]></title><description><![CDATA[<p>This is just a quick note to say that the next minor version of Elegance is in development. The next release (version 2.7.1) will feature a lot of bug fixes and a couple of new features. If you’d like to follow development you can check the status of the <a href="https://github.com/thedannywahl/moodle-theme_elegance/issues?milestone=1&amp;page=1&amp;state=open">2.7.1 Milestone over at github</a>. It’s already past due by a day- but we had a lot of new issues opened in the last week that we wanted to fix before a new release. In general we do a lot of testing on the weekly+ and master branches of Moodle so we <em>should</em> be able to get a release out the door one week behind a Moodle release.</p>

<p>So what do you need to do to get ready for the next version? I suggest you head over to the <a href="http://realfavicongenerator.net/">Favicon Generator</a> and make sure you have branding for all your mobile devices.</p>]]></description><link>https://iyware.com/elegance-whats-coming/</link><guid isPermaLink="false">79d0f9f9-72ae-4b96-9992-d33bb70ca661</guid><category><![CDATA[Moodle]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Tue, 22 Jul 2014 07:56:12 GMT</pubDate></item><item><title><![CDATA[Moodle $OUTPUT: An Introduction]]></title><description><![CDATA[<p>Here at iyWare we’re not really developers. Sure we write some code, and we have even released a few plugins for <a href="https://github.com/thedannywahl/Zebra_4_Moodle_2">Moodle</a>, <a href="https://github.com/thedannywahl/California_4_WordPress_3">WordPress</a>, and <a href="https://github.com/thedannywahl/Zebra_4_Mahara">Mahara</a> but really we’re in the educational technology consulting business. Recently <a href="http://www.iyware.com/new-home-elegance/" title="New Home for Elegance">we took over development</a> of the <a href="https://moodle.org/plugins/view.php?plugin=theme_elegance" title="Elegance">Elegance</a> Moodle theme from its original author and began auditing the code. We quickly released a <a href="http://www.iyware.com/elegance-2-7-release/" title="Elegance 2.7 release">Moodle 2.7 compatible</a> version- but to the (<a href="https://moodle.org/mod/forum/discuss.php?d=263376#p1141999">understandable</a>) <a href="https://moodle.org/mod/forum/discuss.php?d=263376#p1142297">dissatisfaction</a> <a href="https://moodle.org/mod/forum/discuss.php?d=263376#p1142539">of a lot</a> <a href="https://moodle.org/mod/forum/discuss.php?d=263376#p1143365">of users</a> some of the changes we made were perceived as “worse” or at least “not better” than the older version of the theme. So in this post I’d like to clarify why some of the changes we made were made and why they’re actually better. This may get a bit technical but I’ll try to keep it simple.</p>

<h2 id="doutputrulesall">$OUTPUT Rules All</h2>

<p>In Moodle what a plugin can do is determined by what kind of plugin it is. This is logical AND makes sense. For example an activity (say Forum) is not allowed to ask you if you want to change your site logo. Other software, like WordPress aren’t so well defined. Have you ever changed themes and had an entire post-type (like testimonials) disappear? That’s because themes in WordPress are allowed to do things beyond change the look and feel of the site. Imagine in Moodle if you changed your theme and suddenly couldn’t use the Quiz module any more! So we have a good system of permissions in Moodle and what’s allowed to do what.</p>

<p>Now we’re going to introduce you to <code>$OUTPUT</code>. $OUTPUT is a variable (meaning its content changes) that stores everything that gets output to a page- i.e. what you see in Moodle. This is a not-quite-technically-accurate definition because there are other global variables like <code>$CFG</code>, <code>$THEME</code>, <code>$PAGE</code>, <code>$USER</code>, and <code>$DB</code> but I think you get the idea. When a plugin has some data or information that it wants to display on the screen it gives it to $OUTPUT. For example, a list of quiz questions, or a button group that says “ok” or “cancel”. Generally the way that things are given to, read from, or changed in $OUTPUT is via what’s called in programming language a "<a href="http://en.wikipedia.org/wiki/Method_%28programming%29">method</a>". Simply stated a method is a way of doing things- this applies offline as well as online. I have a method of stacking our plates (largest on bottom, smallest on top) so they don’t fall over. People have various methods of parking their cars- and the method varies depending on the type of parking spot.</p>

<h2 id="methodtothemadness">Method to the Madness</h2>

<p>Methods in Moodle are defined by Moodle core- and this is why a quiz can’t change a logo or a theme can’t add an activity type. Moodle core will, in a programmatic way, tell the plugin “sorry you can’t do that.” There’s pretty much one exception to this, themes actually CAN do pretty much whatever they want with $OUTPUT. Sure, there are a few limitations (like the example above) but really they can add to, remove from, or change ANYTHING inside of $OUTPUT. This isn’t actually a bad thing, look and feel some times requires to a degree modifying the document structure- some times! The bad thing is that ONLY themes have this power. So let’s give an example of why this is good, and then an example of why it might be bad.</p>

<h3 id="thegoodfonticons">The Good: Font Icons</h3>

<p>Iconography definitely falls into the “look &amp; feel” department. So if a theme wants to use a font icon (like <a href="http://fontawesome.io/">fontawesome</a> it will have to change $OUTPUT. The transaction would look something like this:</p>

<blockquote>
  <p>Quiz Module: Hey, $OUTPUT the user is adding a quiz to the course page. Make sure you use that piece of paper with a fat red check mark on it as the icon.</p>
  
  <p>$OUTPUT: Cool, thanks for that info.</p>
  
  <p>$OUTPUT: Yo! Theme, here’s everything you need to put on the page, get to work.</p>
  
  <p>Theme plugin: Hold up $OUTPUT Imma let you finish, but font-awesome has the best icons. So We’re going to use a “question mark” icon instead.</p>
</blockquote>

<p>Ta-da! Now you’re using an icon font to change the look-and feel of your website, but not really changing the functionality- which is the textbook definition of what a theme should do.</p>

<h3 id="thebadsharethislinks">The Bad: “Share This” Links</h3>

<p>Let’s say you work at an actually-forward-thinking school that’s not bound by stuff like COPPA or CISPA, or a think-of-the-children mindset, or just a university. Pretend your school really wants to be able to add an array of “share this” links at the bottom of every forum post, next to the “reply”, “edit”, and “permalink” links. There are a number of options that you might try (or think you can try):</p>

<h4 id="localplugintype">“local” plugin type</h4>

<p>At first a developer might think “I’ll just make a small plugin that modifies the method that makes forum posts to include “share” links. They write a “local” plugin- meaning it’s not one of the well-defined plugin types (like assignment, theme, authentication, etc…) and write their new version of the method- and voila! It doesn’t work! Remember, Moodle tells plugins that they can’t change other plugins’ methods or their part of $OUTPUT.</p>

<h4 id="forum2electricboogaloo">Forum 2: Electric Boogaloo!</h4>

<p>The next option is to fork (or make a copy of) the forum module and change its name (and all mentions of its name) to something different, like “Forum 2″. Then you change the method of your new module to add sharing links. Install the new Forum 2 on your Moodle and people can start using it. But now you have 2 forum modules. Do you leave them both enabled? One without sharing links and the other with? No, that’s silly- turn off the old forum. And now your Moodle administrator has 9,000 emails from teachers and students saying they can’t find their old posts- their conditional activities and course completion are broken. Fix it! Fix it! Fix it!. Now you need to write <em>another</em> plugin called a “tool” that takes all of the old “Forum” instances on your site and converts them to “Forum 2″ types. What a nightmare! And don’t forget as soon as Moodle updates the original “Forum” you need to track those changes and copy them to your new version.</p>

<h4 id="or">Or…</h4>

<h3 id="theuglythesocialesttheme">The Ugly: The Social-est Theme</h3>

<p>Instead of continuing with the “social” sharing example let’s switch to another one. Assume that you want to add some touch icons to your theme. There’s a variety of ways to achieve this and we’ll look at some of them here, with their drawbacks and advantages.</p>

<h4 id="thehtmlway">The “HTML” Way</h4>

<p>This is probably the most straight forward way to add touch icons to your theme. Simply put the icons in the /pix/ folder and add the meta tag to your layout. Of course if your theme uses multiple layout files (which it probably does) you’ll need to add it to all all 5 or 6 or 7 layout files. The downside here is that by working outside of the image API you will probably cause some caching issues- and you <em>might</em> even end up with broken images, depending on the site config.</p>

<h4 id="themoodleway">The “Moodle” Way</h4>

<p>So why not just use the pix_url() method instead? Good idea, actually! Then your touch icons are handled Moodle and all edge cases of config and cache are taken into account for you. But what if you have different themes for desktop and for mobile?</p>

<h4 id="andonitgoes">And On it Goes…</h4>

<p>Okay, rather than itemizing every option we’re simply going to go down the rabbit trail. Now what if your site has a different theme for desktop vs. mobile? Simply add the new method and the images to both themes. Now what if your site allows teachers to choose their own course theme? Simply add the new method and images to all themes. Now what if some of those themes are “core” themes (included with Moodle) like “More”? Simply clone that theme (see the bullet point above) and add the method and images to your new theme OR create a new “child” theme (a theme that requires another theme) and add your method and images to that theme OR edit the core code [please don’t do that!!!!]</p>

<p>Did we mention that if you make a child theme to make a few modifications that settings aren’t inherited? They’re not. So if you want to clone “more” and make a few changes you’re really out of luck. You’re really just inheriting layout, styles, and JS – which would be good if that’s all themes could do. But that custom logo you created? Nope.</p>

<p>You might as well make your own theme. There is one final option, if you don’t have an in-house developer who can build and maintain a theme your only option is to ask a theme developer to add a feature to a theme. Which we get a lot of, and usually they’re very specific to that instance and wouldn’t be a good general inclusion for a them. But the reason that people ask is because of what’s specifically outlined above- there’s no other way to do it.</p>

<h2 id="rubbermeetstheroad">Rubber Meets the Road</h2>

<p>Okay there’s a bit of a background, now let’s look at some of the things specific to Elegance.</p>

<h3 id="courseresourcetiles">Course Resource Tiles</h3>

<p>As we’ve stated, one of the core responsibilities of a theme is to control the look and feel. The “Tiled Resources” was a cool look &amp; feel feature but it wasn’t a complete feature- it took the big resource output and reformatted it as a box instead of a rectangle, and then “floated” it so they stacked next to each other. We removed this from the theme because it wasn’t <em>fully</em> functional- and the functionality that it was trying to create already has a definition: “Course Format”. Remember how we said a theme can’t create a new activity? Well we shouldn’t try to have it <em>pretend</em> like it has added other plugin types- we should actually create them. Very quickly, off the top of my head, here’s a list of the problems with the Tiled Resources as it existed in the theme that would need to be fixed for it to be fully functional:</p>

<ul>
<li>Does it work across multiple course formats (including third party?)</li>
<li>How are labels output inside of the “box”?</li>
<li>How are folders w/ expanded content displayed in the “box”?</li>
<li>How does a resource with the “Description” shown on the page look?</li>
<li>How does the list of conditional access rules look on the page?</li>
<li>Does “drag and drop” reordering of resources work?</li>
<li>How do indented (move right/left) resources look?</li>
<li>How do boxes look on a mobile phone or tablet? Desktop?</li>
</ul>

<p>All of these things fall into the definition of a course format- which a theme could then tweak the look and feel of, but ADDING all of this stuff to a theme is like cramming two plugins into one. On top of that you have a little bit of “vendor lock in”. We all know that teachers shouldn’t tailor their display to their theme and/or device – but they do. And this facilitates that. As an admin you’d never be able to remove or change Elegance as a theme option because suddenly <em>poof</em> Tiled Resources is gone. That’s not good.</p>

<h3 id="mycoursetileblock">My Course Tile Block</h3>

<p>Let me just start by saying that the function that added this part to the theme was called something like “theme_elegance_my_course_tiles_fake_block”. That should be enough right there. A theme is a theme, a block is a block. A fake block in a theme is NOT a block. And here’s the problem(s) with it:</p>

<ul>
<li>No block settings (global)</li>
<li>No block config (per-block)</li>
<li>Users can’t hide, move, or dock the block</li>
</ul>

<p>All of those things are required by a block type plugin, but a theme modifying doesn’t have to follow the block rules to the detriment of the user. Not to mention, again, that if you switch themes you lose your block- unlike all other block types.</p>

<h2 id="conclusion">Conclusion</h2>

<p>In conclusion there are three main ways that themes modify $OUTPUT of a Moodle site:</p>

<ol>
<li>Strictly changing look and feel without changing functionality  </li>
<li>Adding functionality that <em>can’t</em> be added by other plugin types  </li>
<li>Adding functionality that <em>can</em> by added by other plugin types</li>
</ol>

<p>The above two examples are examples of #3. They were providing functionality that should be provided by “real” plugins. This makes testing and maintaining the theme exponentially harder because you usage cases and configuration options increase with each additional fake plugin you add to your theme.</p>

<p>Now, to be clear, we didn’t remove these features from Elegance simply because ideally they should be a standalone plugin. We removed them because they were broken. Sure, for most simple Moodle installs they mostly worked, but we have to support all Moodle installs. And the only way to ensure that it works properly is to build the functionality correctly. So, while we understand that it’s not fun to lose functionality (especially stuff you really like!) we’re now on the path to being able to do it the right way.</p>]]></description><link>https://iyware.com/moodle-output-an-introduction/</link><guid isPermaLink="false">da4fb4ba-9b6e-4f6e-a3f1-41c4eeeb5c7f</guid><category><![CDATA[Moodle]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Fri, 18 Jul 2014 16:44:33 GMT</pubDate></item><item><title><![CDATA[Elegance 2.7 release]]></title><description><![CDATA[<p>It’s taken a little bit longer than we had hoped but we’re happy to announce that the official 2.7 version of Elegance has been released! It’s currently available in the <a href="https://moodle.org/plugins/view.php?plugin=theme_elegance">Moodle plugins directory</a>.</p>

<p>As with all of our releases we have also opened a new <a href="https://moodle.org/mod/forum/discuss.php?d=263376">support thread</a> at the moodle.org forums. Since this is our first release since taking over development of this plugin we were primarily on a “how does this work?” expedition. As such there’s not a lot of new functionality, but there are quite a few bugs that have been fixed.</p>

<p>The two biggest changes in this release are </p>

<ol>
<li>official Moodle 2.7 compatibility  </li>
<li>dependence on moodle-theme_bootstrap</li>
</ol>

<p>This is not to be confused with “bootstrapbase” which is included in Moodle 2.7. But, in the effort of easing confusion – if you’re using the Moodle auto-updater (which you should be) you’ll automatically be prompted to install this parent theme first. This also allowed us to lighten the code base- a lot!</p>

<p><a href="https://github.com/thedannywahl/moodle-theme_elegance/compare/7c80461...2.7.0.06">199 changed files with <strong>982</strong> additions and <strong>36,422</strong> deletions</a></p>

<p>Finally we’d like to thank all the <a href="https://github.com/thedannywahl/moodle-theme_elegance/graphs/contributors">contributors</a> and <a href="https://github.com/thedannywahl/moodle-theme_elegance/issues?state=open">bug reporters</a> that helped make this release possible.</p>

<p>Well what are you waiting for? <a href="https://moodle.org/plugins/view.php?plugin=theme_elegance">Go get it</a>!</p>]]></description><link>https://iyware.com/elegance-2-7-release/</link><guid isPermaLink="false">26a2e1d1-7c63-4255-bebf-89868ac5a236</guid><category><![CDATA[Moodle]]></category><dc:creator><![CDATA[Danny Wahl]]></dc:creator><pubDate>Fri, 04 Jul 2014 23:11:28 GMT</pubDate></item></channel></rss>
