<!DOCTYPE html>
<html>

<!-- Mirrored from localhost:2368/making-wordpress-password-protected-posts-private/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 04 Mar 2015 02:38:18 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>iyWare | Making WordPress Password Protected Posts Private</title>
    <meta name="description" content="" />

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="../favicon.ico">

    <link rel="stylesheet" type="text/css" href="../assets/css/screen.min2de3.css?v=93f8bccb5f" />

    <link rel="canonical" href="https://iyware.com/making-wordpress-password-protected-posts-private/" />
    
    <meta property="og:site_name" content="iyWare" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Making WordPress Password Protected Posts Private" />
    <meta property="og:description" content="Boy that’s a lot of ‘P’s! Let’s just jump right in, shall we. Here’s the scenario, a user creates a post that they only want to share with select people because of the private nature of..." />
    <meta property="og:url" content="https://iyware.com/making-wordpress-password-protected-posts-private/" />
    <meta property="article:published_time" content="2011-11-28T12:37:43.000Z" />
    <meta property="article:modified_time" content="2015-01-19T02:15:43.997Z" />
    <meta property="article:tag" content="WordPress" />
    
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:title" content="Making WordPress Password Protected Posts Private" />
    <meta name="twitter:description" content="Boy that’s a lot of ‘P’s! Let’s just jump right in, shall we. Here’s the scenario, a user creates a post that they only want to share with select people because of the private nature of..." />
    <meta name="twitter:url" content="https://iyware.com/making-wordpress-password-protected-posts-private/" />
    
    <script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "Article",
    "publisher": "iyWare",
    "author": {
        "@type": "Person",
        "name": "Danny Wahl",
        "image": "https://iyware.com/content/images/2015/01/me.jpg",
        "url": "https://iyware.com/author/danny",
        "sameAs": null
    },
    "headline": "Making WordPress Password Protected Posts Private",
    "url": "https://iyware.com/making-wordpress-password-protected-posts-private/",
    "datePublished": "2011-11-28T12:37:43.000Z",
    "dateModified": "2015-01-19T02:15:43.997Z",
    "keywords": "WordPress",
    "description": "Boy that’s a lot of ‘P’s! Let’s just jump right in, shall we. Here’s the scenario, a user creates a post that they only want to share with select people because of the private nature of..."
}
    </script>

    <meta name="generator" content="Ghost 0.5" />
    <link rel="alternate" type="application/rss+xml" title="iyWare" href="https://iyware.com/rss/" />
</head>
<body class="post-template tag-wordpress  noimage">

    


    <article role="main" class="">
        <header class="group">
            <a href="../" id="home_link">«</a>
            <div class="hgroup">
            	<h1>Making WordPress Password Protected Posts Private</h1>
            	<div class="meta">
            		<time datetime="2011-11-28">November 28, 2011</time>
            		&nbsp;&bull;&nbsp;
					<span class="tags"><a href="../tag/wordpress/">WordPress</a></span>
            	</div>
			</div>
        </header>

        <div class="text" id="js-post-content">
            <p>Boy that’s a lot of ‘P’s! Let’s just jump right in, shall we. Here’s the scenario, a user creates a post that they only want to share with select people because of the private nature of the post (notice I say post, not “content”) so they password their post and publish it. WordPress by default will block <code>the_content()</code> from displaying as well as <code>comments_template()</code>. That’s good! What’s not good is the amount of thing it doesn’t block. For example:</p>

<ul>
<li>Post Title</li>
<li>Author</li>
<li>Post Date &amp; time</li>
<li>Featured Image</li>
<li>The fact that comments are enabled</li>
<li>The post shows up in search &amp; archives</li>
</ul>

<p>There may be other things but this was the quick set I saw that I knew I needed to change. Turns out we can do this in just a couple of quick steps. First let’s look at what might be a standard single.php:</p>

<pre><code class="language-php">&lt;?php get_header(); ?&gt;  
    &lt;article id="post-&lt;?php the_ID(); ?&gt;" &lt;?php post_class(); ?&gt;&gt;
        &lt;header&gt;&lt;h2&gt;&lt;?php the_title(); ?&gt;&lt;/h2&gt;&lt;/header&gt;
        &lt;aside id="meta"&gt;&lt;?php the_author(); ?&gt; : &lt;?php the_date(); ?&gt;&lt;/aside&gt;
        &lt;?php if ( has_post_thumbnail() ) : ?&gt;
            &lt;?php $post_thumbnail_id = get_post_thumbnail_id($post-&gt;ID); ?&gt;
            &lt;figure&gt;
                &lt;?php echo wp_get_attachment_link( $post_thumbnail_id, 'thumbnail', true ); ?&gt;
                &lt;figcaption&gt;This is an image caption&lt;/figcaption&gt;
            &lt;/figure&gt;
        &lt;?php endif; ?&gt;
        &lt;?php the_content(); ?&gt;
    &lt;/article&gt;
    &lt;?php comments_template(); ?&gt;
&lt;?php get_footer(); ?&gt;  
</code></pre>

<p>Pretty simple, let’s break it down: Grab the header, the the author, time, and featured image, then the content and the comments. The only thing that wouldn’t show up would be the comments and the content. The title would also be prefixed with “Protected: “. That sure is a lot of information for a “Protected” post. Let’s fix that.</p>

<h2 id="singlephp">single.php</h2>

<p>The first step is to add a conditional to our above code, fortunately there’s an article class called <code>post-password-required</code> when a post is passworded and the user hasn’t input the password before. We’re going to leverage that by using the php function <a href="http://php.net/manual/en/function.in-array.php"><code>in_array()</code></a>.</p>

<pre><code class="language-php">&lt;?php get_header(); ?&gt;  
    &lt;?php if ( in_array( "post-password-required", get_post_class() ) ) : ?&gt;
        &lt;article id="post-&lt;?php the_ID(); ?&gt;"&gt;
            &lt;header&gt;&lt;h2&gt;Password Required&lt;/h2&gt;&lt;/header&gt;
            &lt;?php the_content(); ?&gt;
        &lt;/article&gt;
    &lt;?php else : ?&gt;
        &lt;article id="post-&lt;?php the_ID(); ?&gt;" &lt;?php post_class(); ?&gt;&gt;
            &lt;header&gt;&lt;h2&gt;&lt;?php the_title(); ?&gt;&lt;/h2&gt;&lt;/header&gt;
            &lt;aside id="meta"&gt;&lt;?php the_author(); ?&gt; : &lt;?php the_date(); ?&gt;&lt;/aside&gt;
            &lt;?php if ( has_post_thumbnail() ) : ?&gt;
                &lt;?php $post_thumbnail_id = get_post_thumbnail_id($post-&gt;ID); ?&gt;
                &lt;figure&gt;
                    &lt;?php echo wp_get_attachment_link( $post_thumbnail_id, 'thumbnail', true ); ?&gt;
                    &lt;figcaption&gt;This is an image caption&lt;/figcaption&gt;
                &lt;/figure&gt;
            &lt;?php endif; ?&gt;
            &lt;?php the_content(); ?&gt;
            &lt;?php comments_template(); ?&gt;
        &lt;/article&gt;
    &lt;?php endif; ?&gt;
&lt;?php get_footer(); ?&gt;  
</code></pre>

<p>So if the post is going to require a password, we don’t serve any of that other content, just <code>the_content()</code>. We don’t even give them the title of the article.</p>

<p>Next we’re going to remove our protected posts from archive, search, category, and tag lists, again just to prevent exposing that the post even exists, because that could be annoying to visitors that don’t have the password! We’re going to achieve this by filtering our queries on those types of pages.</p>

<h2 id="functionsphp">functions.php</h2>

<pre><code class="language-php">// Exclude passworded posts from search and archive
function password_post_exclude($where, $wp_query = NULL) {  
    global $wpdb;  
    if ( ! $wp_query ) {
        global $wp_query;
    }
    if ( $wp_query-&gt;is_archive  || $wp_query-&gt;is_search ) {  
        $where .= " AND $wpdb-&gt;posts.post_password = ''";  
    }  
    return $where;  
}  
add_filter( 'posts_where','password_post_exclude', 1, 2 );  
</code></pre>

<p>This is a pretty simple filter, we’re just using the <a href="http://codex.wordpress.org/Class_Reference/wpdb"><code>wpdb</code></a> class to append one more rule to the database query, and that rule is that the post password must be null. Kind of an odd way to do it, but this is the only way to check if a post is protected or not (in a query).</p>

<h2 id="notes">Notes</h2>

<p>That’s all there is to making your protected posts a little more private. Now I know what you’re thinking, obfuscation isn’t security. I know that. This isn’t to make things more secure, this is to increase the privacy of the post by limiting what information is shown and removing it from general access. I know what else you’re thinking: If your website is open to search engines your post is still going to get crawled and indexed for people to find. Yes and no; yes it will get crawled but here’s what it will index: Title: “Password Required” Content: “You need a password to view this post”. Versus the default of: Title: “Protected: Your Secret Post Title” Content: “You need a password to view this post”. So even if it gets indexed it’s not going to show up in search results, and again this isn’t about security!</p>

<p>Finally, since we’re serving our own title for the protected post you can remove the WP prep-end from the title with another custom function:</p>

<pre><code class="language-php">// Remove "Protected: " from passworded posts because we serve our own title
function strip_the_title( $title ) {  
    $title = attribute_escape( $title );
    $modified = '#Protected: #';
    $original = '';
    $title = preg_replace( $modified, $original, $title );
    return $title;
}
add_filter( 'the_title', 'strip_the_title' );  
</code></pre>
            <!--sse-->
			<div id="disqus_thread"></div>
			<script type="text/javascript">
				var disqus_shortname = 'iyware';
				(function() {
					var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
					dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
					(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				})();
			</script>
			<noscript><p style="text-align:center;"><small>Please enable JavaScript to view the <a href="https://disqus.com/home/forums/iyware/">comments powered by Disqus.</a></small></p></noscript>
			<!--/sse-->
        </div>

        <footer class="post-footer" role="contentinfo">

            <div class="vcard">
                <a href="../rss/" id="btn_feed" class="btn" title="Feed">
                    <span aria-hidden="true" data-icon=")"></span>
                    <strong>Feed</strong>
                </a>

                <a href="../" class="photo">
                    <span style="background-image: url('../content/images/2015/01/me.jpg');">
                        <img src="../content/images/2015/01/me.jpg" alt="Danny Wahl">
                    </span>
                </a>

                <div class="details">
                    <h4><a href="../" class="url n">Danny Wahl</a></h4>
                    <!--sse--><span>danny &#64; iyware.com</span><br/><!--/sse-->
                    <span>License: <a href="http://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></span><br/>
                    
              
                </div>
            </div>

            <div id="user_bio">
                <div class="inner">
                    My name is Danny Wahl and I provide IT management and consulting in the APAC region. I dabble in writing, programming, design, and ukulele playing.
                </div>
            </div>

        </footer>

    </article>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
	<ins class="adsbygoogle" style="display:inline-block;width:320px;height:100px" data-ad-client="ca-pub-5811335018322110" data-ad-slot="8562617448"></ins>
	<script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script>




    <script src="../public/jquery2de3.js?v=93f8bccb5f"></script>

		<script type="text/javascript" src="../assets/js/prism.min2de3.js?v=93f8bccb5f"></script>
	

	<aside style="display:none;">
		<a href="../search/">Search</a>
		<a href="../clients/">Clients</a>
	</aside>
</body>

<!-- Mirrored from localhost:2368/making-wordpress-password-protected-posts-private/ by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 04 Mar 2015 02:38:18 GMT -->
</html>
